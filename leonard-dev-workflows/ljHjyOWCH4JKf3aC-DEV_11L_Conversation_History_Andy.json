{
  "name": "DEV - 11L Conversation History - Andy",
  "nodes": [
    {
      "parameters": {
        "operation": "upsert",
        "base": {
          "__rl": true,
          "value": "appgNEAJQIzCvvAUs",
          "mode": "list",
          "cachedResultName": "Legal Engine - 11L Full Conversation History",
          "cachedResultUrl": "https://airtable.com/appgNEAJQIzCvvAUs"
        },
        "table": {
          "__rl": true,
          "value": "tblSItjoCdvOZC0d7",
          "mode": "list",
          "cachedResultName": "Non EU",
          "cachedResultUrl": "https://airtable.com/appgNEAJQIzCvvAUs/tblSItjoCdvOZC0d7"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "start_time_unix_secs": "={{ $json.start_time_unix_secs }}",
            "call_duration_secs": "={{ $json.call_duration_secs }}",
            "message_count": "={{ $json.message_count }}",
            "branch_id": "={{ $json.branch_id }}",
            "agent_name": "={{ $json.agent_name }}",
            "conversation_id": "={{ $json.conversation_id }}",
            "transcript_summary": "={{ $json.transcript_summary }}",
            "call_summary_title": "={{ $json.call_summary_title }}",
            "direction": "={{ $json.direction }}",
            "call_successful": "={{ $json.call_successful }}",
            "agent_id": "={{ $json.agent_id }}",
            "status": "={{ $json.status }}",
            "has_more": "={{ $json.has_more }}",
            "next_cursor": "={{ $json.next_cursor }}"
          },
          "matchingColumns": [
            "conversation_id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "conversation_id",
              "displayName": "conversation_id",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "agent_id",
              "displayName": "agent_id",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "branch_id",
              "displayName": "branch_id",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "agent_name",
              "displayName": "agent_name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "start_time_unix_secs",
              "displayName": "start_time_unix_secs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "call_duration_secs",
              "displayName": "call_duration_secs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "message_count",
              "displayName": "message_count",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "status",
              "displayName": "status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "todo",
                  "value": "todo"
                },
                {
                  "name": "in progress",
                  "value": "in progress"
                },
                {
                  "name": "done",
                  "value": "done"
                },
                {
                  "name": "in-progress",
                  "value": "in-progress"
                },
                {
                  "name": "failed",
                  "value": "failed"
                },
                {
                  "name": "initiated",
                  "value": "initiated"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "call_successful",
              "displayName": "call_successful",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "yes",
                  "value": "yes"
                },
                {
                  "name": "no",
                  "value": "no"
                },
                {
                  "name": "unknown",
                  "value": "unknown"
                },
                {
                  "name": "success",
                  "value": "success"
                },
                {
                  "name": "failure",
                  "value": "failure"
                },
                {
                  "name": "in-progress",
                  "value": "in-progress"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "transcript_summary",
              "displayName": "transcript_summary",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "call_summary_title",
              "displayName": "call_summary_title",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "direction",
              "displayName": "direction",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "next_cursor",
              "displayName": "next_cursor",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "has_more",
              "displayName": "has_more",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "boolean",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "extra",
              "displayName": "extra",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        -1488,
        -640
      ],
      "id": "964805c0-230c-4b68-b95b-1be122355abc",
      "name": "Create or update a record",
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Input: one item with { conversations, next_cursor, has_more }\nconst src = items[0]?.json ?? {};\nconst { conversations = [], next_cursor, has_more } = src;\n\nreturn conversations.map((c) => ({\n  json: {\n    ...c,\n    next_cursor: String(next_cursor ?? ''),     // Airtable text\n    has_more: has_more === true || has_more === 'true', // real boolean\n  },\n  pairedItem: { item: 0 },\n}));\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1712,
        -640
      ],
      "id": "c82edbc5-7209-410c-af0b-b1668af8b2b2",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "operation": "upsert",
        "base": {
          "__rl": true,
          "value": "appgNEAJQIzCvvAUs",
          "mode": "list",
          "cachedResultName": "NON EU - 11L Full Conversation History",
          "cachedResultUrl": "https://airtable.com/appgNEAJQIzCvvAUs"
        },
        "table": {
          "__rl": true,
          "value": "tbl2il3we2HNssC2U",
          "mode": "list",
          "cachedResultName": "Non EU Agents",
          "cachedResultUrl": "https://airtable.com/appgNEAJQIzCvvAUs/tbl2il3we2HNssC2U"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "agent_id": "={{ $json.agents.agent_id }}",
            "agent_name": "={{ $json.agents.name }}",
            "created_by": "={{ $json.agents.access_info.creator_name }}",
            "creator_email": "={{ $json.agents.access_info.creator_email }}",
            "created_time_unix_secs": "={{ $json.agents.created_at_unix_secs }}",
            "last_call_time_unix_secs": "={{ $json.agents.last_call_time_unix_secs }}",
            "message_count": 0,
            "is_creator": "={{ $json.agents.access_info.is_creator }}",
            "role": "={{ $json.agents.access_info.role }}"
          },
          "matchingColumns": [
            "agent_id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "agent_id",
              "displayName": "agent_id",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "agent_name",
              "displayName": "agent_name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "created_time_unix_secs",
              "displayName": "created_time_unix_secs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "last_call_time_unix_secs",
              "displayName": "last_call_time_unix_secs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "created_by",
              "displayName": "created_by",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "creator_email",
              "displayName": "creator_email",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "message_count",
              "displayName": "message_count",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "status",
              "displayName": "status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "todo",
                  "value": "todo"
                },
                {
                  "name": "in progress",
                  "value": "in progress"
                },
                {
                  "name": "done",
                  "value": "done"
                },
                {
                  "name": "in-progress",
                  "value": "in-progress"
                }
              ],
              "readOnly": false,
              "removed": true
            },
            {
              "id": "is_creator",
              "displayName": "is_creator",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "role",
              "displayName": "role",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "archived",
              "displayName": "archived",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "boolean",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Last Modified By",
              "displayName": "Last Modified By",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": false
            },
            {
              "id": "Last Modified",
              "displayName": "Last Modified",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": false
            },
            {
              "id": "Created",
              "displayName": "Created",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": false
            },
            {
              "id": "Created By",
              "displayName": "Created By",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        -1920,
        -992
      ],
      "id": "e5b684ef-a150-4cd5-9301-bb7b57ae675c",
      "name": "Create or update a record1",
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      }
    },
    {
      "parameters": {
        "fieldToSplitOut": "agents",
        "include": "allOtherFields",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        -2144,
        -992
      ],
      "id": "d4cdf086-73b1-4c29-a2c1-1774c204dd89",
      "name": "Split Out"
    },
    {
      "parameters": {
        "content": "## Get Non-EU Agents\n",
        "height": 320,
        "width": 1008
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2608,
        -1152
      ],
      "typeVersion": 1,
      "id": "fc1e80de-1150-4bf7-a845-d782e5e6a01f",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "operation": "upsert",
        "base": {
          "__rl": true,
          "value": "appgNEAJQIzCvvAUs",
          "mode": "list",
          "cachedResultName": "NON EU - 11L Full Conversation History",
          "cachedResultUrl": "https://airtable.com/appgNEAJQIzCvvAUs"
        },
        "table": {
          "__rl": true,
          "value": "tblCGE0kBi7nkppib",
          "mode": "list",
          "cachedResultName": "EU Agents",
          "cachedResultUrl": "https://airtable.com/appgNEAJQIzCvvAUs/tblCGE0kBi7nkppib"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "agent_id": "={{ $json.agents.agent_id }}",
            "agent_name": "={{ $json.agents.name }}",
            "created_by": "={{ $json.agents.access_info.creator_name }}",
            "creator_email": "={{ $json.agents.access_info.creator_email }}",
            "created_time_unix_secs": "={{ $json.agents.created_at_unix_secs }}",
            "last_call_time_unix_secs": "={{ $json.agents.last_call_time_unix_secs }}",
            "message_count": 0,
            "is_creator": "={{ $json.agents.access_info.is_creator }}",
            "role": "={{ $json.agents.access_info.role }}"
          },
          "matchingColumns": [
            "agent_id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "agent_id",
              "displayName": "agent_id",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "agent_name",
              "displayName": "agent_name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "created_time_unix_secs",
              "displayName": "created_time_unix_secs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "last_call_time_unix_secs",
              "displayName": "last_call_time_unix_secs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "created_by",
              "displayName": "created_by",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "creator_email",
              "displayName": "creator_email",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "message_count",
              "displayName": "message_count",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "status",
              "displayName": "status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "todo",
                  "value": "todo"
                },
                {
                  "name": "in progress",
                  "value": "in progress"
                },
                {
                  "name": "done",
                  "value": "done"
                },
                {
                  "name": "in-progress",
                  "value": "in-progress"
                }
              ],
              "readOnly": false,
              "removed": true
            },
            {
              "id": "is_creator",
              "displayName": "is_creator",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "boolean",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "role",
              "displayName": "role",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "archived",
              "displayName": "archived",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "boolean",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Last Modified By",
              "displayName": "Last Modified By",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": false
            },
            {
              "id": "Last Modified",
              "displayName": "Last Modified",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": false
            },
            {
              "id": "Created",
              "displayName": "Created",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": false
            },
            {
              "id": "Created By",
              "displayName": "Created By",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        -1920,
        -1360
      ],
      "id": "4d98de15-793a-480e-ba36-18f140c5db20",
      "name": "Create or update a record3",
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      }
    },
    {
      "parameters": {
        "fieldToSplitOut": "agents",
        "include": "allOtherFields",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        -2144,
        -1360
      ],
      "id": "cc3af907-8872-49fb-9f36-046654dfe770",
      "name": "Split Out1"
    },
    {
      "parameters": {
        "content": "## Get EU Agents\n",
        "height": 320,
        "width": 1008
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2592,
        -1520
      ],
      "typeVersion": 1,
      "id": "c55fcc58-53be-45b7-90c7-b197ede000aa",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "url": "https://api.eu.residency.elevenlabs.io/v1/convai/agents",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "xi-api-key",
              "value": "sk_d832e838a1760cf1457606e24547413d73132dbff2184dbe_residency_eu"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {}
          ]
        },
        "options": {
          "batching": {
            "batch": {
              "batchSize": 1
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2368,
        -1360
      ],
      "id": "e24d8c68-1dc0-43f0-aa5f-d0c742d4e365",
      "name": "Get 11L EU Agents"
    },
    {
      "parameters": {
        "url": "https://api.elevenlabs.io/v1/convai/agents",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "xi-api-key",
              "value": "sk_3eca705a3c2780af4cb1116beb64d3e1d3bfc187a8d565f8"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {}
          ]
        },
        "options": {
          "batching": {
            "batch": {
              "batchSize": 1
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2368,
        -992
      ],
      "id": "7d929e74-0377-4a1a-9cd3-99154cabc806",
      "name": "Get 11L Non_EU Agents"
    },
    {
      "parameters": {
        "url": "={{ $json.url }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "xi-api-key",
              "value": "sk_3eca705a3c2780af4cb1116beb64d3e1d3bfc187a8d565f8"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {}
          ]
        },
        "options": {
          "batching": {
            "batch": {
              "batchSize": 1
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1936,
        -640
      ],
      "id": "cb3c9c81-db6f-49f2-b8fa-e99af2304bfd",
      "name": "Get 11L Non-EU Conversations"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "ceee9760-d0b0-4d5b-abe2-41b2d1015903",
              "leftValue": "={{ $json.fields.has_more }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -1264,
        -640
      ],
      "id": "0785ce08-2f21-4976-9169-c2e610340033",
      "name": "If"
    },
    {
      "parameters": {
        "operation": "upsert",
        "base": {
          "__rl": true,
          "value": "appgNEAJQIzCvvAUs",
          "mode": "list",
          "cachedResultName": "Legal Engine - 11L Full Conversation History",
          "cachedResultUrl": "https://airtable.com/appgNEAJQIzCvvAUs"
        },
        "table": {
          "__rl": true,
          "value": "tblKMB2WVbOPSPMUN",
          "mode": "list",
          "cachedResultName": "EU",
          "cachedResultUrl": "https://airtable.com/appgNEAJQIzCvvAUs/tblKMB2WVbOPSPMUN"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "start_time_unix_secs": "={{ $json.start_time_unix_secs }}",
            "call_duration_secs": "={{ $json.call_duration_secs }}",
            "message_count": "={{ $json.message_count }}",
            "branch_id": "={{ $json.branch_id }}",
            "agent_name": "={{ $json.agent_name }}",
            "conversation_id": "={{ $json.conversation_id }}",
            "transcript_summary": "={{ $json.transcript_summary }}",
            "call_summary_title": "={{ $json.call_summary_title }}",
            "direction": "={{ $json.direction }}",
            "call_successful": "={{ $json.call_successful }}",
            "agent_id": "={{ $json.agent_id }}",
            "status": "={{ $json.status }}",
            "has_more": "={{ $('Get 11L EU Agents1').item.json.has_more }}",
            "next_cursor": "={{ $('Get 11L EU Agents1').item.json.next_cursor }}"
          },
          "matchingColumns": [
            "conversation_id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "conversation_id",
              "displayName": "conversation_id",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "agent_id",
              "displayName": "agent_id",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "branch_id",
              "displayName": "branch_id",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "agent_name",
              "displayName": "agent_name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "start_time_unix_secs",
              "displayName": "start_time_unix_secs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "call_duration_secs",
              "displayName": "call_duration_secs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "message_count",
              "displayName": "message_count",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "status",
              "displayName": "status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "todo",
                  "value": "todo"
                },
                {
                  "name": "in progress",
                  "value": "in progress"
                },
                {
                  "name": "done",
                  "value": "done"
                },
                {
                  "name": "in-progress",
                  "value": "in-progress"
                },
                {
                  "name": "failed",
                  "value": "failed"
                },
                {
                  "name": "initiated",
                  "value": "initiated"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "call_successful",
              "displayName": "call_successful",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "yes",
                  "value": "yes"
                },
                {
                  "name": "no",
                  "value": "no"
                },
                {
                  "name": "unknown",
                  "value": "unknown"
                },
                {
                  "name": "success",
                  "value": "success"
                },
                {
                  "name": "failure",
                  "value": "failure"
                },
                {
                  "name": "in-progress",
                  "value": "in-progress"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "transcript_summary",
              "displayName": "transcript_summary",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "call_summary_title",
              "displayName": "call_summary_title",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "direction",
              "displayName": "direction",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "next_cursor",
              "displayName": "next_cursor",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "has_more",
              "displayName": "has_more",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "boolean",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "extra",
              "displayName": "extra",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        -1488,
        160
      ],
      "id": "6f208cb0-6dd8-4675-81ef-922658015adb",
      "name": "Create or update a record6",
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "url": "={{ $json.url }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "xi-api-key",
              "value": "sk_d832e838a1760cf1457606e24547413d73132dbff2184dbe_residency_eu"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {}
          ]
        },
        "options": {
          "batching": {
            "batch": {
              "batchSize": 1
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1936,
        -208
      ],
      "id": "f8a63a05-3c4c-4fc3-8a1e-e29fd6c79838",
      "name": "Get 11L EU Agents1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "663c8833-6db2-411f-9f0f-ec8b5f19390c",
              "name": "url",
              "value": "={{ \"https://api.elevenlabs.io/v1/convai/conversations?page_size=50&cursor=\" + ($json[\"next_cursor\"] || \"\") }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2160,
        -640
      ],
      "id": "0888d75d-736d-4708-bd5d-7311607b92c2",
      "name": "Edit Fields2"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -2416,
        -208
      ],
      "id": "ae09cf1e-a625-466d-bcd7-40dc4d73cd0c",
      "name": "When clicking ‘Execute workflow’"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0660f68c-10d6-4e54-be05-25d6688b195c",
              "name": "has_more",
              "value": "={{ $json.fields.has_more }}",
              "type": "boolean"
            },
            {
              "id": "15619cc2-b427-4599-9b98-2d32ec85dae9",
              "name": "next_cursor",
              "value": "={{ $json.fields.next_cursor }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1024,
        -656
      ],
      "id": "332b71b3-0ecb-4241-aa0b-2aa35766067b",
      "name": "Edit Fields3"
    },
    {
      "parameters": {
        "content": "## Get Non-EU Conversations",
        "height": 320,
        "width": 1952
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2608,
        -752
      ],
      "typeVersion": 1,
      "id": "ecb74831-6760-4d1d-8bcb-eeebfa585b07",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "content": "## Get EU Conversations",
        "height": 384,
        "width": 1952
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2592,
        -320
      ],
      "typeVersion": 1,
      "id": "97a3f118-ac62-4573-88b6-b2e5e6799730",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "ceee9760-d0b0-4d5b-abe2-41b2d1015903",
              "leftValue": "={{ $json.fields.has_more }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -1264,
        -208
      ],
      "id": "0b86505e-b3eb-4f1f-a2bf-7aaabd574bcb",
      "name": "If1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "663c8833-6db2-411f-9f0f-ec8b5f19390c",
              "name": "url",
              "value": "={{ \"https://api.eu.residency.elevenlabs.io/v1/convai/conversations?page_size=50&cursor=\" + ($json[\"next_cursor\"] || \"\") }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2160,
        -208
      ],
      "id": "35b53493-00b2-4404-ac1d-585a845324e5",
      "name": "Edit Fields4"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0660f68c-10d6-4e54-be05-25d6688b195c",
              "name": "has_more",
              "value": "={{ $('Get 11L EU Agents1').item.json.has_more }}",
              "type": "boolean"
            },
            {
              "id": "15619cc2-b427-4599-9b98-2d32ec85dae9",
              "name": "next_cursor",
              "value": "={{ $('Get 11L EU Agents1').item.json.next_cursor }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1024,
        -224
      ],
      "id": "f28d6c46-c31d-46ac-87d3-709a16053dc5",
      "name": "Edit Fields5"
    },
    {
      "parameters": {
        "jsCode": "// Input: one item whose $json has { conversations: [...], has_more, next_cursor }\n// Output: one item per conversation at root\nconst out = [];\nconst convs = $json.conversations || [];\nfor (const c of convs) {\n  out.push({ json: c });\n}\nreturn out;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1712,
        160
      ],
      "id": "17f00882-f39b-4927-b2dc-12b37f705c50",
      "name": "Code in JavaScript2",
      "disabled": true
    },
    {
      "parameters": {
        "jsCode": "// Input: one item whose $json has { conversations: [...], has_more, next_cursor }\n// Output: one item per conversation at root\nconst out = [];\nconst convs = $json.conversations || [];\nfor (const c of convs) {\n  out.push({ json: c });\n}\nreturn out;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1712,
        -848
      ],
      "id": "3f907733-064c-4cd2-9bcb-cbf9c8942e0e",
      "name": "Code in JavaScript1",
      "disabled": true
    },
    {
      "parameters": {
        "operation": "upsert",
        "base": {
          "__rl": true,
          "value": "appgNEAJQIzCvvAUs",
          "mode": "list",
          "cachedResultName": "Legal Engine - 11L Full Conversation History",
          "cachedResultUrl": "https://airtable.com/appgNEAJQIzCvvAUs"
        },
        "table": {
          "__rl": true,
          "value": "tblSItjoCdvOZC0d7",
          "mode": "list",
          "cachedResultName": "Non EU",
          "cachedResultUrl": "https://airtable.com/appgNEAJQIzCvvAUs/tblSItjoCdvOZC0d7"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "start_time_unix_secs": "={{ $json.start_time_unix_secs }}",
            "call_duration_secs": "={{ $json.call_duration_secs }}",
            "message_count": "={{ $json.message_count }}",
            "branch_id": "={{ $json.branch_id }}",
            "agent_name": "={{ $json.agent_name }}",
            "conversation_id": "={{ $json.conversation_id }}",
            "transcript_summary": "={{ $json.transcript_summary }}",
            "call_summary_title": "={{ $json.call_summary_title }}",
            "direction": "={{ $json.direction }}",
            "call_successful": "={{ $json.call_successful }}",
            "agent_id": "={{ $json.agent_id }}",
            "status": "={{ $json.status }}",
            "next_cursor": "={{ $('Get 11L Non-EU Conversations').item.json.next_cursor }}",
            "has_more": "={{ $('Get 11L Non-EU Conversations').item.json.has_more }}"
          },
          "matchingColumns": [
            "conversation_id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "conversation_id",
              "displayName": "conversation_id",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "agent_id",
              "displayName": "agent_id",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "branch_id",
              "displayName": "branch_id",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "agent_name",
              "displayName": "agent_name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "start_time_unix_secs",
              "displayName": "start_time_unix_secs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "call_duration_secs",
              "displayName": "call_duration_secs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "message_count",
              "displayName": "message_count",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "status",
              "displayName": "status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "todo",
                  "value": "todo"
                },
                {
                  "name": "in progress",
                  "value": "in progress"
                },
                {
                  "name": "done",
                  "value": "done"
                },
                {
                  "name": "in-progress",
                  "value": "in-progress"
                },
                {
                  "name": "failed",
                  "value": "failed"
                },
                {
                  "name": "initiated",
                  "value": "initiated"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "call_successful",
              "displayName": "call_successful",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "yes",
                  "value": "yes"
                },
                {
                  "name": "no",
                  "value": "no"
                },
                {
                  "name": "unknown",
                  "value": "unknown"
                },
                {
                  "name": "success",
                  "value": "success"
                },
                {
                  "name": "failure",
                  "value": "failure"
                },
                {
                  "name": "in-progress",
                  "value": "in-progress"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "transcript_summary",
              "displayName": "transcript_summary",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "call_summary_title",
              "displayName": "call_summary_title",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "direction",
              "displayName": "direction",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "next_cursor",
              "displayName": "next_cursor",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "has_more",
              "displayName": "has_more",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "boolean",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "extra",
              "displayName": "extra",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        -1488,
        -848
      ],
      "id": "ba77b1ad-f884-4372-a1ff-2a5e7d10509d",
      "name": "Create or update a record2",
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "operation": "upsert",
        "base": {
          "__rl": true,
          "value": "appgNEAJQIzCvvAUs",
          "mode": "list",
          "cachedResultName": "Legal Engine - 11L Full Conversation History",
          "cachedResultUrl": "https://airtable.com/appgNEAJQIzCvvAUs"
        },
        "table": {
          "__rl": true,
          "value": "tblKMB2WVbOPSPMUN",
          "mode": "list",
          "cachedResultName": "EU",
          "cachedResultUrl": "https://airtable.com/appgNEAJQIzCvvAUs/tblKMB2WVbOPSPMUN"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "start_time_unix_secs": "={{ $json.start_time_unix_secs }}",
            "call_duration_secs": "={{ $json.call_duration_secs }}",
            "message_count": "={{ $json.message_count }}",
            "branch_id": "={{ $json.branch_id }}",
            "agent_name": "={{ $json.agent_name }}",
            "conversation_id": "={{ $json.conversation_id }}",
            "transcript_summary": "={{ $json.transcript_summary }}",
            "call_summary_title": "={{ $json.call_summary_title }}",
            "direction": "={{ $json.direction }}",
            "call_successful": "={{ $json.call_successful }}",
            "agent_id": "={{ $json.agent_id }}",
            "status": "={{ $json.status }}",
            "has_more": "={{ $('Get 11L EU Agents1').item.json.has_more }}",
            "next_cursor": "={{ $('Get 11L EU Agents1').item.json.next_cursor }}"
          },
          "matchingColumns": [
            "conversation_id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "conversation_id",
              "displayName": "conversation_id",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "agent_id",
              "displayName": "agent_id",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "branch_id",
              "displayName": "branch_id",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "agent_name",
              "displayName": "agent_name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "start_time_unix_secs",
              "displayName": "start_time_unix_secs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "call_duration_secs",
              "displayName": "call_duration_secs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "message_count",
              "displayName": "message_count",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "status",
              "displayName": "status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "todo",
                  "value": "todo"
                },
                {
                  "name": "in progress",
                  "value": "in progress"
                },
                {
                  "name": "done",
                  "value": "done"
                },
                {
                  "name": "in-progress",
                  "value": "in-progress"
                },
                {
                  "name": "failed",
                  "value": "failed"
                },
                {
                  "name": "initiated",
                  "value": "initiated"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "call_successful",
              "displayName": "call_successful",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "yes",
                  "value": "yes"
                },
                {
                  "name": "no",
                  "value": "no"
                },
                {
                  "name": "unknown",
                  "value": "unknown"
                },
                {
                  "name": "success",
                  "value": "success"
                },
                {
                  "name": "failure",
                  "value": "failure"
                },
                {
                  "name": "in-progress",
                  "value": "in-progress"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "transcript_summary",
              "displayName": "transcript_summary",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "call_summary_title",
              "displayName": "call_summary_title",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "direction",
              "displayName": "direction",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "next_cursor",
              "displayName": "next_cursor",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "has_more",
              "displayName": "has_more",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "boolean",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "extra",
              "displayName": "extra",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        -1488,
        368
      ],
      "id": "9642daea-fd8c-426a-8250-8b8189c888af",
      "name": "Create or update a record7",
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "jsCode": "// Input: one item whose $json has { conversations: [...], has_more, next_cursor }\n// Output: one item per conversation at root\nconst out = [];\nconst convs = $json.conversations || [];\nfor (const c of convs) {\n  out.push({ json: c });\n}\nreturn out;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1712,
        368
      ],
      "id": "c1a49cc2-a3ef-4048-9f50-ac7389de4ed3",
      "name": "Code in JavaScript3",
      "disabled": true
    },
    {
      "parameters": {
        "operation": "upsert",
        "base": {
          "__rl": true,
          "value": "appgNEAJQIzCvvAUs",
          "mode": "list",
          "cachedResultName": "Legal Engine - 11L Full Conversation History",
          "cachedResultUrl": "https://airtable.com/appgNEAJQIzCvvAUs"
        },
        "table": {
          "__rl": true,
          "value": "tblSItjoCdvOZC0d7",
          "mode": "list",
          "cachedResultName": "Non EU",
          "cachedResultUrl": "https://airtable.com/appgNEAJQIzCvvAUs/tblSItjoCdvOZC0d7"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "start_time_unix_secs": "={{ $json.start_time_unix_secs }}",
            "call_duration_secs": "={{ $json.call_duration_secs }}",
            "message_count": "={{ $json.message_count }}",
            "branch_id": "={{ $json.branch_id }}",
            "agent_name": "={{ $json.agent_name }}",
            "conversation_id": "={{ $json.conversation_id }}",
            "transcript_summary": "={{ $json.transcript_summary }}",
            "call_summary_title": "={{ $json.call_summary_title }}",
            "direction": "={{ $json.direction }}",
            "call_successful": "={{ $json.call_successful }}",
            "agent_id": "={{ $json.agent_id }}",
            "status": "={{ $json.status }}",
            "has_more": "={{ $json.has_more }}",
            "next_cursor": "={{ $json.next_cursor }}"
          },
          "matchingColumns": [
            "conversation_id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "conversation_id",
              "displayName": "conversation_id",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "agent_id",
              "displayName": "agent_id",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "branch_id",
              "displayName": "branch_id",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "agent_name",
              "displayName": "agent_name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "start_time_unix_secs",
              "displayName": "start_time_unix_secs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "call_duration_secs",
              "displayName": "call_duration_secs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "message_count",
              "displayName": "message_count",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "status",
              "displayName": "status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "todo",
                  "value": "todo"
                },
                {
                  "name": "in progress",
                  "value": "in progress"
                },
                {
                  "name": "done",
                  "value": "done"
                },
                {
                  "name": "in-progress",
                  "value": "in-progress"
                },
                {
                  "name": "failed",
                  "value": "failed"
                },
                {
                  "name": "initiated",
                  "value": "initiated"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "call_successful",
              "displayName": "call_successful",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "yes",
                  "value": "yes"
                },
                {
                  "name": "no",
                  "value": "no"
                },
                {
                  "name": "unknown",
                  "value": "unknown"
                },
                {
                  "name": "success",
                  "value": "success"
                },
                {
                  "name": "failure",
                  "value": "failure"
                },
                {
                  "name": "in-progress",
                  "value": "in-progress"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "transcript_summary",
              "displayName": "transcript_summary",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "call_summary_title",
              "displayName": "call_summary_title",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "direction",
              "displayName": "direction",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "next_cursor",
              "displayName": "next_cursor",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "has_more",
              "displayName": "has_more",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "boolean",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "extra",
              "displayName": "extra",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        -1488,
        -208
      ],
      "id": "0ed998b5-4d00-4166-8b0a-179dedc6b914",
      "name": "Create or update a record4",
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Input: one item with { conversations, next_cursor, has_more }\nconst src = items[0]?.json ?? {};\nconst { conversations = [], next_cursor, has_more } = src;\n\nreturn conversations.map((c) => ({\n  json: {\n    ...c,\n    next_cursor: String(next_cursor ?? ''),     // Airtable text\n    has_more: has_more === true || has_more === 'true', // real boolean\n  },\n  pairedItem: { item: 0 },\n}));\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1712,
        -208
      ],
      "id": "bc78df7f-a438-4e7b-affe-4fb6d8f3c0d0",
      "name": "Code in JavaScript4"
    }
  ],
  "connections": {
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Create or update a record",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create or update a record": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out": {
      "main": [
        [
          {
            "node": "Create or update a record1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out1": {
      "main": [
        [
          {
            "node": "Create or update a record3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get 11L EU Agents": {
      "main": [
        [
          {
            "node": "Split Out1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get 11L Non_EU Agents": {
      "main": [
        [
          {
            "node": "Split Out",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get 11L Non-EU Conversations": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Edit Fields3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create or update a record6": {
      "main": [
        []
      ]
    },
    "Get 11L EU Agents1": {
      "main": [
        [
          {
            "node": "Code in JavaScript4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields2": {
      "main": [
        [
          {
            "node": "Get 11L Non-EU Conversations",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When clicking ‘Execute workflow’": {
      "main": [
        [
          {
            "node": "Edit Fields4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields3": {
      "main": [
        [
          {
            "node": "Edit Fields2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Edit Fields5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields4": {
      "main": [
        [
          {
            "node": "Get 11L EU Agents1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields5": {
      "main": [
        [
          {
            "node": "Edit Fields4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript2": {
      "main": [
        [
          {
            "node": "Create or update a record6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript3": {
      "main": [
        [
          {
            "node": "Create or update a record7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript4": {
      "main": [
        [
          {
            "node": "Create or update a record4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create or update a record4": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "pinData": {},
  "triggerCount": 0,
  "meta": {
    "templateCredsSetupCompleted": true
  }
}