{
  "name": "DEV - Z1 - Agent Conversation History - owner Andy",
  "nodes": [
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "authentication": "airtableTokenApi",
        "baseId": {
          "__rl": true,
          "value": "appZVIzjrI2yMRYTT",
          "mode": "id"
        },
        "tableId": {
          "__rl": true,
          "value": "tbli6Lbg7SwnxcmNj",
          "mode": "id"
        },
        "triggerField": "=Transcript ID",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.airtableTrigger",
      "typeVersion": 1,
      "position": [
        -960,
        -400
      ],
      "id": "56c8ad61-f8d5-4881-86b1-1c432845c202",
      "name": "New Conversation",
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "operation": "search",
        "base": {
          "__rl": true,
          "value": "appZVIzjrI2yMRYTT",
          "mode": "list",
          "cachedResultName": "Agent History DEV",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT"
        },
        "table": {
          "__rl": true,
          "value": "tbli6Lbg7SwnxcmNj",
          "mode": "list",
          "cachedResultName": "Agent History DEV",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT/tbli6Lbg7SwnxcmNj"
        },
        "filterByFormula": "={Email}='{{ $json.Email }}'",
        "options": {
          "fields": [
            "Call Transcript"
          ]
        }
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        -512,
        -400
      ],
      "id": "96b4f0e1-a93d-4ca9-85e7-489f06bdb849",
      "name": "Search records1",
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "base": {
          "__rl": true,
          "value": "appZVIzjrI2yMRYTT",
          "mode": "list",
          "cachedResultName": "Agent History DEV",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT"
        },
        "table": {
          "__rl": true,
          "value": "tbli6Lbg7SwnxcmNj",
          "mode": "list",
          "cachedResultName": "Agent History DEV",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT/tbli6Lbg7SwnxcmNj"
        },
        "id": "={{ $json.id }}",
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        -736,
        -400
      ],
      "id": "25651f7c-78e7-4a3b-81ad-3bec54050055",
      "name": "Get conversation",
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json['Call Transcript'] }}",
        "options": {
          "systemMessage": "You are an expert in taking a series of conversations summaries and consolidating them into the most recent consolidated version that with an axe as the knowledge base for a future AI voice agent"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        -64,
        -400
      ],
      "id": "aada4215-afdb-471b-aea9-ffce23b678e5",
      "name": "AI Agent",
      "disabled": true
    },
    {
      "parameters": {
        "projectId": {
          "__rl": true,
          "value": "vertex-ai-api-setup-via-cli",
          "mode": "id"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleVertex",
      "typeVersion": 1,
      "position": [
        -56,
        -176
      ],
      "id": "debaa631-8fad-47af-92b6-e7a372058d69",
      "name": "Google Vertex Chat Model1",
      "credentials": {
        "googleApi": {
          "id": "LQjM9YuYI3HxJBrE",
          "name": "Google Service Account - Edu account Oct 8th"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "base": {
          "__rl": true,
          "value": "appZVIzjrI2yMRYTT",
          "mode": "list",
          "cachedResultName": "Agent History DEV",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT"
        },
        "table": {
          "__rl": true,
          "value": "tbli6Lbg7SwnxcmNj",
          "mode": "list",
          "cachedResultName": "Agent History DEV",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT/tbli6Lbg7SwnxcmNj"
        },
        "id": "={{ $('Search records1').item.json.id }}",
        "options": {}
      },
      "type": "n8n-nodes-base.airtableTool",
      "typeVersion": 2.1,
      "position": [
        72,
        -176
      ],
      "id": "b90a2f98-2cf7-4e0a-bf47-e387724fe3af",
      "name": "Get a record in Airtable",
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "fieldsToAggregate": {
          "fieldToAggregate": [
            {
              "fieldToAggregate": "Call Transcript"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        -288,
        -400
      ],
      "id": "21924d73-4db0-4c6c-ab35-12d095b56582",
      "name": "Aggregate",
      "disabled": true
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "authentication": "airtableTokenApi",
        "baseId": {
          "__rl": true,
          "value": "appZVIzjrI2yMRYTT",
          "mode": "id"
        },
        "tableId": {
          "__rl": true,
          "value": "tbli6Lbg7SwnxcmNj",
          "mode": "id"
        },
        "triggerField": "Created",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.airtableTrigger",
      "typeVersion": 1,
      "position": [
        -960,
        128
      ],
      "id": "905c854f-13a8-4ba3-8cbd-c0e6a2960b03",
      "name": "New Conversation1",
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json['Call Transcript'] }}",
        "options": {
          "systemMessage": "You are an expert in taking a series of conversations summaries and consolidating them into the most recent consolidated version that with an axe as the knowledge base for a future AI voice agent"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        -736,
        784
      ],
      "id": "63d1cbdd-1140-42fb-8147-4b692c9715a4",
      "name": "AI Agent1",
      "disabled": true
    },
    {
      "parameters": {
        "projectId": {
          "__rl": true,
          "value": "vertex-ai-api-setup-via-cli",
          "mode": "id"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleVertex",
      "typeVersion": 1,
      "position": [
        -728,
        1008
      ],
      "id": "7b1e01ad-c502-4cb4-a253-f7fa2a00c979",
      "name": "Google Vertex Chat Model",
      "credentials": {
        "googleApi": {
          "id": "LQjM9YuYI3HxJBrE",
          "name": "Google Service Account - Edu account Oct 8th"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "base": {
          "__rl": true,
          "value": "appZVIzjrI2yMRYTT",
          "mode": "list",
          "cachedResultName": "Agent History DEV",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT"
        },
        "table": {
          "__rl": true,
          "value": "tbli6Lbg7SwnxcmNj",
          "mode": "list",
          "cachedResultName": "Agent History DEV",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT/tbli6Lbg7SwnxcmNj"
        },
        "id": "={{ $('Search for new conv').item.json.id }}",
        "options": {}
      },
      "type": "n8n-nodes-base.airtableTool",
      "typeVersion": 2.1,
      "position": [
        -600,
        1008
      ],
      "id": "6a3bc365-75aa-42e2-a5fa-84897941ab07",
      "name": "Get a record in Airtable1",
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "fieldsToAggregate": {
          "fieldToAggregate": [
            {
              "fieldToAggregate": "Call Transcript"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        -960,
        784
      ],
      "id": "1eeba7ca-c51d-42ce-a483-0e228751bd42",
      "name": "Aggregate1",
      "disabled": true
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "156090cc-9c17-4309-89eb-1171f9745d19",
              "leftValue": "={{ $('Search existing records').item.json['Conversation history'] }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            },
            {
              "id": "02c9fb25-20ed-4783-9f34-9dd4de44b315",
              "leftValue": "={{ $json.output }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        960,
        128
      ],
      "id": "67cc4277-d639-4b79-8560-25ad100124db",
      "name": "If",
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "projectId": {
          "__rl": true,
          "value": "vertex-ai-api-setup-via-cli",
          "mode": "id"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleVertex",
      "typeVersion": 1,
      "position": [
        680,
        352
      ],
      "id": "7400576c-f62a-4824-b61b-c5bb80e2d2f6",
      "name": "Google Vertex Chat Model2",
      "credentials": {
        "googleApi": {
          "id": "LQjM9YuYI3HxJBrE",
          "name": "Google Service Account - Edu account Oct 8th"
        }
      }
    },
    {
      "parameters": {
        "base": {
          "__rl": true,
          "value": "appZVIzjrI2yMRYTT",
          "mode": "list",
          "cachedResultName": "Agent History DEV",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT"
        },
        "table": {
          "__rl": true,
          "value": "tbli6Lbg7SwnxcmNj",
          "mode": "list",
          "cachedResultName": "Agent History DEV",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT/tbli6Lbg7SwnxcmNj"
        },
        "id": "={{ $json.id }}",
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        -736,
        128
      ],
      "id": "e73a4a7e-0b3f-4b13-9321-62e24a28362b",
      "name": "Get new conversation",
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      }
    },
    {
      "parameters": {
        "operation": "search",
        "base": {
          "__rl": true,
          "value": "appZVIzjrI2yMRYTT",
          "mode": "list",
          "cachedResultName": "Agent History DEV",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT"
        },
        "table": {
          "__rl": true,
          "value": "tbli6Lbg7SwnxcmNj",
          "mode": "list",
          "cachedResultName": "Agent History DEV",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT/tbli6Lbg7SwnxcmNj"
        },
        "filterByFormula": "={Email}='{{ $json.Email }}'",
        "returnAll": false,
        "limit": 1,
        "options": {
          "fields": [
            "Call Transcript",
            "Email",
            "Full Name",
            "First Name",
            "Last Name",
            "Transcript ID",
            "Date Last Updated",
            "Call Length (s)"
          ]
        },
        "sort": {
          "property": [
            {
              "field": "Date Last Updated"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        -288,
        128
      ],
      "id": "db1eb22b-3d95-4608-918e-82f275dd6e6b",
      "name": "Search for new conv",
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      }
    },
    {
      "parameters": {
        "operation": "search",
        "base": {
          "__rl": true,
          "value": "appZVIzjrI2yMRYTT",
          "mode": "list",
          "cachedResultName": "Agent History DEV",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT"
        },
        "table": {
          "__rl": true,
          "value": "tbl59SsynUjxCB488",
          "mode": "list",
          "cachedResultName": "Agent History Summary Per Person",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT/tbl59SsynUjxCB488"
        },
        "filterByFormula": "={Email}='{{ $json.Email }}'",
        "returnAll": false,
        "limit": 1,
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        -64,
        128
      ],
      "id": "51b06a08-2970-4cf9-a591-cca8a2721480",
      "name": "Search existing records",
      "alwaysOutputData": true,
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=New Conversation Transcript: {{ $('Get new conversation').item.json['Call Transcript'] }}",
        "options": {
          "systemMessage": "You are an expert in conversation summaries and creating a version that will act as the knowledge base for a future conversation with an AI voice agent. When producing the output, just provide the summary, no introduction, in long prose and containing all pertinent details. Make sure to log all fact. "
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        608,
        128
      ],
      "id": "74536333-6d15-4bd9-89a5-e84f73474e81",
      "name": "Create new single conv summary"
    },
    {
      "parameters": {
        "operation": "create",
        "base": {
          "__rl": true,
          "value": "appZVIzjrI2yMRYTT",
          "mode": "list",
          "cachedResultName": "Agent History DEV",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT"
        },
        "table": {
          "__rl": true,
          "value": "tbl59SsynUjxCB488",
          "mode": "list",
          "cachedResultName": "Agent History Summary Per Person",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT/tbl59SsynUjxCB488"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Call Length (s)": "={{ $('Search for new conv').item.json[\"Call Length (s)\"] }}",
            "Email": "={{ $('Search for new conv').item.json.Email }}",
            "Transcript ID": "={{ $('Search for new conv').item.json.id }}",
            "Full Name": "={{ $('Search for new conv').item.json[\"Full Name\"] }}",
            "First Name": "={{ $('Search for new conv').item.json[\"First Name\"] }}",
            "Last Name": "={{ $('Search for new conv').item.json[\"Last Name\"] }}",
            "Conversation history": "={{ $json.output }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Transcript ID",
              "displayName": "Transcript ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Full Name",
              "displayName": "Full Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "First Name",
              "displayName": "First Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Last Name",
              "displayName": "Last Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Date Last Updated",
              "displayName": "Date Last Updated",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Too Short?",
              "displayName": "Too Short?",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "boolean",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Length (s)",
              "displayName": "Call Length (s)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Total Call Length (s)",
              "displayName": "Total Call Length (s)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Length (m)",
              "displayName": "Call Length (m)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Last Modified",
              "displayName": "Last Modified",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Created By",
              "displayName": "Created By",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Last Modified By",
              "displayName": "Last Modified By",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Summary",
              "displayName": "Call Summary",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Cost",
              "displayName": "Call Cost",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "LLM Charge",
              "displayName": "LLM Charge",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Charge",
              "displayName": "Call Charge",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Agent ID",
              "displayName": "Agent ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Status 11L",
              "displayName": "Call Status 11L",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Termination Reason",
              "displayName": "Termination Reason",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Error Reason",
              "displayName": "Error Reason",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Successful 11L?",
              "displayName": "Call Successful 11L?",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Email recipient",
              "displayName": "Email recipient",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Email Copy",
              "displayName": "Email Copy",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Conversation Date",
              "displayName": "Conversation Date",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Conversation history",
              "displayName": "Conversation history",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Recommended Session 1",
              "displayName": "Recommended Session 1",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Recommended Session 2",
              "displayName": "Recommended Session 2",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Recommended Session 3",
              "displayName": "Recommended Session 3",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Goal 1",
              "displayName": "Goal 1",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Goal 2",
              "displayName": "Goal 2",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Goal 3",
              "displayName": "Goal 3",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Recco Speaker 1",
              "displayName": "Recco Speaker 1",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Recco Speaker 2",
              "displayName": "Recco Speaker 2",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Recco Speaker 3",
              "displayName": "Recco Speaker 3",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        1184,
        224
      ],
      "id": "883db219-7f5f-4545-833f-c80d47fdfede",
      "name": "Create new conv summary",
      "alwaysOutputData": true,
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      }
    },
    {
      "parameters": {
        "projectId": {
          "__rl": true,
          "value": "vertex-ai-api-setup-via-cli",
          "mode": "id"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleVertex",
      "typeVersion": 1,
      "position": [
        1704,
        256
      ],
      "id": "18e1f8ee-8be6-4e19-97ee-1661f6b77cc2",
      "name": "Google Vertex Chat Model3",
      "credentials": {
        "googleApi": {
          "id": "LQjM9YuYI3HxJBrE",
          "name": "Google Service Account - Edu account Oct 8th"
        }
      }
    },
    {
      "parameters": {
        "operation": "upsert",
        "base": {
          "__rl": true,
          "value": "appZVIzjrI2yMRYTT",
          "mode": "list",
          "cachedResultName": "Agent History DEV",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT"
        },
        "table": {
          "__rl": true,
          "value": "tbl59SsynUjxCB488",
          "mode": "list",
          "cachedResultName": "Agent History Summary Per Person",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT/tbl59SsynUjxCB488"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Call Length (s)": "={{ $('Search for new conv').item.json[\"Call Length (s)\"] }}",
            "Email": "={{ $('Search for new conv').item.json.Email }}",
            "Transcript ID": "={{ $('Search for new conv').item.json.id }}",
            "Conversation history": "={{ $json.output }}"
          },
          "matchingColumns": [
            "Email"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": false
            },
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Transcript ID",
              "displayName": "Transcript ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Full Name",
              "displayName": "Full Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "First Name",
              "displayName": "First Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Last Name",
              "displayName": "Last Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Date Last Updated",
              "displayName": "Date Last Updated",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Too Short?",
              "displayName": "Too Short?",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "boolean",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Length (s)",
              "displayName": "Call Length (s)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Total Call Length (s)",
              "displayName": "Total Call Length (s)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Length (m)",
              "displayName": "Call Length (m)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Last Modified",
              "displayName": "Last Modified",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Created By",
              "displayName": "Created By",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Last Modified By",
              "displayName": "Last Modified By",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Summary",
              "displayName": "Call Summary",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Cost",
              "displayName": "Call Cost",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "LLM Charge",
              "displayName": "LLM Charge",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Charge",
              "displayName": "Call Charge",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Agent ID",
              "displayName": "Agent ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Status 11L",
              "displayName": "Call Status 11L",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Termination Reason",
              "displayName": "Termination Reason",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Error Reason",
              "displayName": "Error Reason",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Successful 11L?",
              "displayName": "Call Successful 11L?",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Email recipient",
              "displayName": "Email recipient",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Email Copy",
              "displayName": "Email Copy",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Conversation Date",
              "displayName": "Conversation Date",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Conversation history",
              "displayName": "Conversation history",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Recommended Session 1",
              "displayName": "Recommended Session 1",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Recommended Session 2",
              "displayName": "Recommended Session 2",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Recommended Session 3",
              "displayName": "Recommended Session 3",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Goal 1",
              "displayName": "Goal 1",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Goal 2",
              "displayName": "Goal 2",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Goal 3",
              "displayName": "Goal 3",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Recco Speaker 1",
              "displayName": "Recco Speaker 1",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Recco Speaker 2",
              "displayName": "Recco Speaker 2",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Recco Speaker 3",
              "displayName": "Recco Speaker 3",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        1984,
        32
      ],
      "id": "65d22a84-0dfa-4218-92ff-19977f2e8518",
      "name": "Create new conv summary1",
      "alwaysOutputData": true,
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Latest Call Summary: {{ $('Create new single conv summary').item.json.output }}\nPrior call Summaries: {{ $('Search existing records').item.json['Conversation history'] }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=You are an expert in taking a series of conversations summaries and consolidating them into a single output which is a consolidated version. This consolodated version will act as the knowledge base for a future AI voice agent. You should make sure to use as much detail as possible, prioritising information from the Latest Call Summary ({{ $('Create new single conv summary').item.json.output }}) over the Prior call Summaries ({{ $('Search existing records').item.json['Conversation history'] }}) to ensure the knowledge base has a bias for more up to date information. When producing the single output, just provide the summary, no introduction, in long prose and containing all pertinent details. Begin with details from the Latest Call Summary ({{ $('Create new single conv summary').item.json.output }}). Make sure to include as much detail as possible, linking relevant points to provide a robust history of the conversation. "
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        1632,
        32
      ],
      "id": "087682f3-c337-4b97-9477-657c6fa7967c",
      "name": "Conv history agent"
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "authentication": "airtableTokenApi",
        "baseId": {
          "__rl": true,
          "value": "https://airtable.com/appZVIzjrI2yMRYTT/tbli6Lbg7SwnxcmNj/viwBAYtcOMFkmZzhc?blocks=hide",
          "mode": "url"
        },
        "tableId": {
          "__rl": true,
          "value": "https://airtable.com/appZVIzjrI2yMRYTT/tbli6Lbg7SwnxcmNj/viwBAYtcOMFkmZzhc?blocks=hide",
          "mode": "url"
        },
        "triggerField": "Transcript ID",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.airtableTrigger",
      "typeVersion": 1,
      "position": [
        -960,
        456
      ],
      "id": "f1d8784a-836c-4996-861b-f800071ebbb4",
      "name": "Airtable Trigger",
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "authentication": "airtableTokenApi",
        "baseId": {
          "__rl": true,
          "value": "appZVIzjrI2yMRYTT",
          "mode": "id"
        },
        "tableId": {
          "__rl": true,
          "value": "tbli6Lbg7SwnxcmNj",
          "mode": "id"
        },
        "triggerField": "=Transcript ID",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.airtableTrigger",
      "typeVersion": 1,
      "position": [
        -960,
        1364
      ],
      "id": "15053e28-6805-4de7-9480-4ff1ec65fce8",
      "name": "New Conversation2",
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "156090cc-9c17-4309-89eb-1171f9745d19",
              "leftValue": "={{ $json.id }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            },
            {
              "id": "02c9fb25-20ed-4783-9f34-9dd4de44b315",
              "leftValue": "={{ $('Search for new conv1').item.json['Call Transcript'] }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        160,
        1364
      ],
      "id": "5fb384ff-1989-4166-8653-224767ee0139",
      "name": "If1",
      "alwaysOutputData": false,
      "disabled": true
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "735de4f1-f56b-44ff-a5ab-66e8fee102dc",
              "leftValue": "={{ $json[\"Call Length (s)\"] }}",
              "rightValue": 75,
              "operator": {
                "type": "number",
                "operation": "gte"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -512,
        1364
      ],
      "id": "e0f0fe84-f4b5-47a3-ad6f-b194b163c460",
      "name": "75s length1",
      "disabled": true
    },
    {
      "parameters": {
        "projectId": {
          "__rl": true,
          "value": "vertex-ai-api-setup-via-cli",
          "mode": "id"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleVertex",
      "typeVersion": 1,
      "position": [
        456,
        1736
      ],
      "id": "a0d82479-5ca5-44a1-87e5-0bbb59cf4eae",
      "name": "Google Vertex Chat Model4",
      "credentials": {
        "googleApi": {
          "id": "LQjM9YuYI3HxJBrE",
          "name": "Google Service Account - Edu account Oct 8th"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "fieldsToAggregate": {
          "fieldToAggregate": [
            {
              "fieldToAggregate": "Call Transcript",
              "renameField": true,
              "outputFieldName": "=Latest Call Summary "
            },
            {
              "fieldToAggregate": "Conversation history",
              "renameField": true,
              "outputFieldName": "Prior Call Summaries"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        448,
        1216
      ],
      "id": "d3334870-529a-49b3-b2ea-b3ad82774274",
      "name": "Aggregate3",
      "disabled": true
    },
    {
      "parameters": {
        "base": {
          "__rl": true,
          "value": "appZVIzjrI2yMRYTT",
          "mode": "list",
          "cachedResultName": "Agent History DEV",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT"
        },
        "table": {
          "__rl": true,
          "value": "tbli6Lbg7SwnxcmNj",
          "mode": "list",
          "cachedResultName": "Agent History DEV",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT/tbli6Lbg7SwnxcmNj"
        },
        "id": "={{ $json.id }}",
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        -736,
        1364
      ],
      "id": "6d3ae901-6a88-42da-a7ac-fd97ca743880",
      "name": "Get new conversation1",
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "operation": "search",
        "base": {
          "__rl": true,
          "value": "appZVIzjrI2yMRYTT",
          "mode": "list",
          "cachedResultName": "Agent History DEV",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT"
        },
        "table": {
          "__rl": true,
          "value": "tbli6Lbg7SwnxcmNj",
          "mode": "list",
          "cachedResultName": "Agent History DEV",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT/tbli6Lbg7SwnxcmNj"
        },
        "filterByFormula": "={Email}='{{ $json.Email }}'",
        "returnAll": false,
        "limit": 1,
        "options": {
          "fields": [
            "Call Transcript",
            "Email",
            "Full Name",
            "First Name",
            "Last Name",
            "Transcript ID",
            "Date Last Updated",
            "Call Length (s)"
          ]
        },
        "sort": {
          "property": [
            {
              "field": "Date Last Updated"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        -288,
        1364
      ],
      "id": "a0e2b9e8-75dd-4e63-a638-513ff9b83e03",
      "name": "Search for new conv1",
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "operation": "search",
        "base": {
          "__rl": true,
          "value": "appZVIzjrI2yMRYTT",
          "mode": "list",
          "cachedResultName": "Agent History DEV",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT"
        },
        "table": {
          "__rl": true,
          "value": "tbl59SsynUjxCB488",
          "mode": "list",
          "cachedResultName": "Agent History Summary Per Person",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT/tbl59SsynUjxCB488"
        },
        "filterByFormula": "={Email}='{{ $json.Email }}'",
        "returnAll": false,
        "limit": 1,
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        -64,
        1364
      ],
      "id": "71b37a5a-c2f5-443d-b66f-21b354735a78",
      "name": "Search existing records1",
      "alwaysOutputData": true,
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Search for new conv1').item.json[\"Call Transcript\"] }}",
        "options": {
          "systemMessage": "You are an expert in conversation summaries and creating a version that will act as the knowledge base for a future conversation with an AI voice agent"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        384,
        1512
      ],
      "id": "376f3683-7c7a-41e7-aceb-827802ad8701",
      "name": "Create new single conv summary1",
      "disabled": true
    },
    {
      "parameters": {
        "operation": "create",
        "base": {
          "__rl": true,
          "value": "appZVIzjrI2yMRYTT",
          "mode": "list",
          "cachedResultName": "Agent History DEV",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT"
        },
        "table": {
          "__rl": true,
          "value": "tbl59SsynUjxCB488",
          "mode": "list",
          "cachedResultName": "Agent History Summary Per Person",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT/tbl59SsynUjxCB488"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Call Length (s)": "={{ $('Search for new conv1').item.json[\"Call Length (s)\"] }}",
            "Email": "={{ $('Search for new conv1').item.json.Email }}",
            "Transcript ID": "={{ $('Search for new conv1').item.json.id }}",
            "Full Name": "={{ $('Search for new conv1').item.json[\"Full Name\"] }}",
            "First Name": "={{ $('Search for new conv1').item.json[\"First Name\"] }}",
            "Last Name": "={{ $('Search for new conv1').item.json[\"Last Name\"] }}",
            "Conversation history": "={{ $json.output }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Transcript ID",
              "displayName": "Transcript ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Full Name",
              "displayName": "Full Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "First Name",
              "displayName": "First Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Last Name",
              "displayName": "Last Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Date Last Updated",
              "displayName": "Date Last Updated",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Too Short?",
              "displayName": "Too Short?",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "boolean",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Length (s)",
              "displayName": "Call Length (s)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Total Call Length (s)",
              "displayName": "Total Call Length (s)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Length (m)",
              "displayName": "Call Length (m)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Last Modified",
              "displayName": "Last Modified",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Created By",
              "displayName": "Created By",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Last Modified By",
              "displayName": "Last Modified By",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Summary",
              "displayName": "Call Summary",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Cost",
              "displayName": "Call Cost",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "LLM Charge",
              "displayName": "LLM Charge",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Charge",
              "displayName": "Call Charge",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Agent ID",
              "displayName": "Agent ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Status 11L",
              "displayName": "Call Status 11L",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Termination Reason",
              "displayName": "Termination Reason",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Error Reason",
              "displayName": "Error Reason",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Successful 11L?",
              "displayName": "Call Successful 11L?",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Email recipient",
              "displayName": "Email recipient",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Email Copy",
              "displayName": "Email Copy",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Conversation Date",
              "displayName": "Conversation Date",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Conversation history",
              "displayName": "Conversation history",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Recommended Session 1",
              "displayName": "Recommended Session 1",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Recommended Session 2",
              "displayName": "Recommended Session 2",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Recommended Session 3",
              "displayName": "Recommended Session 3",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Goal 1",
              "displayName": "Goal 1",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Goal 2",
              "displayName": "Goal 2",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Goal 3",
              "displayName": "Goal 3",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Recco Speaker 1",
              "displayName": "Recco Speaker 1",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Recco Speaker 2",
              "displayName": "Recco Speaker 2",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Recco Speaker 3",
              "displayName": "Recco Speaker 3",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        800,
        1512
      ],
      "id": "8efc1005-ae86-40a3-9157-e836a4bfc140",
      "name": "Create new conv summary2",
      "alwaysOutputData": true,
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "projectId": {
          "__rl": true,
          "value": "vertex-ai-api-setup-via-cli",
          "mode": "id"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleVertex",
      "typeVersion": 1,
      "position": [
        808,
        1336
      ],
      "id": "818ccc55-8c92-4736-a7d0-aa5d8c87e4c9",
      "name": "Google Vertex Chat Model5",
      "credentials": {
        "googleApi": {
          "id": "LQjM9YuYI3HxJBrE",
          "name": "Google Service Account - Edu account Oct 8th"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "operation": "upsert",
        "base": {
          "__rl": true,
          "value": "appZVIzjrI2yMRYTT",
          "mode": "list",
          "cachedResultName": "Agent History DEV",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT"
        },
        "table": {
          "__rl": true,
          "value": "tbl59SsynUjxCB488",
          "mode": "list",
          "cachedResultName": "Agent History Summary Per Person",
          "cachedResultUrl": "https://airtable.com/appZVIzjrI2yMRYTT/tbl59SsynUjxCB488"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Call Length (s)": "={{ $('Search for new conv1').item.json[\"Call Length (s)\"] }}",
            "Email": "={{ $('Search for new conv1').item.json.Email }}",
            "Transcript ID": "={{ $('Search for new conv1').item.json.id }}",
            "Conversation history": "={{ $json.output }}"
          },
          "matchingColumns": [
            "Email"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": false
            },
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Transcript ID",
              "displayName": "Transcript ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Full Name",
              "displayName": "Full Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "First Name",
              "displayName": "First Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Last Name",
              "displayName": "Last Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Date Last Updated",
              "displayName": "Date Last Updated",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Too Short?",
              "displayName": "Too Short?",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "boolean",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Length (s)",
              "displayName": "Call Length (s)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Total Call Length (s)",
              "displayName": "Total Call Length (s)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Length (m)",
              "displayName": "Call Length (m)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Last Modified",
              "displayName": "Last Modified",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Created By",
              "displayName": "Created By",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Last Modified By",
              "displayName": "Last Modified By",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Summary",
              "displayName": "Call Summary",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Cost",
              "displayName": "Call Cost",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "LLM Charge",
              "displayName": "LLM Charge",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Charge",
              "displayName": "Call Charge",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Agent ID",
              "displayName": "Agent ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Status 11L",
              "displayName": "Call Status 11L",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Termination Reason",
              "displayName": "Termination Reason",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Error Reason",
              "displayName": "Error Reason",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Call Successful 11L?",
              "displayName": "Call Successful 11L?",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Email recipient",
              "displayName": "Email recipient",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Email Copy",
              "displayName": "Email Copy",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Conversation Date",
              "displayName": "Conversation Date",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Conversation history",
              "displayName": "Conversation history",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Recommended Session 1",
              "displayName": "Recommended Session 1",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Recommended Session 2",
              "displayName": "Recommended Session 2",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Recommended Session 3",
              "displayName": "Recommended Session 3",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Goal 1",
              "displayName": "Goal 1",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Goal 2",
              "displayName": "Goal 2",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Goal 3",
              "displayName": "Goal 3",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Recco Speaker 1",
              "displayName": "Recco Speaker 1",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Recco Speaker 2",
              "displayName": "Recco Speaker 2",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Recco Speaker 3",
              "displayName": "Recco Speaker 3",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        1088,
        1216
      ],
      "id": "0f4bef2e-8470-4630-9304-c13dc16e282e",
      "name": "Create new conv summary3",
      "alwaysOutputData": true,
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Latest Call Summary: {{ $json[\"Latest Call Summary \"] }}\nPrior call Summaries: {{ $json[\"Prior Call Summaries\"] }}",
        "options": {
          "systemMessage": "You are an expert in taking a series of conversations summaries and consolidating them into a consolidated version that with an act as the knowledge base for a future AI voice agent. You should make sure to use as much detail as possible, prioritising information from the Latest Call Summary over the Prior call Summaries to ensure the knowledge base has a bias for more up to date information. "
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        736,
        1112
      ],
      "id": "8f875345-b078-4d23-a124-921e4fccc28e",
      "name": "Conv history agent1",
      "disabled": true
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "authentication": "airtableTokenApi",
        "baseId": {
          "__rl": true,
          "value": "https://airtable.com/appZVIzjrI2yMRYTT/tbli6Lbg7SwnxcmNj/viwBAYtcOMFkmZzhc?blocks=hide",
          "mode": "url"
        },
        "tableId": {
          "__rl": true,
          "value": "https://airtable.com/appZVIzjrI2yMRYTT/tbli6Lbg7SwnxcmNj/viwBAYtcOMFkmZzhc?blocks=hide",
          "mode": "url"
        },
        "triggerField": "Transcript ID",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.airtableTrigger",
      "typeVersion": 1,
      "position": [
        -960,
        1840
      ],
      "id": "42baa828-2c0d-4bf7-99e2-05f811996aac",
      "name": "Airtable Trigger1",
      "credentials": {
        "airtableTokenApi": {
          "id": "LVF892xkQD72QD7v",
          "name": "Airtable - Leonard @ Legal Engine"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "735de4f1-f56b-44ff-a5ab-66e8fee102dc",
              "leftValue": "={{ $json[\"Call Length (s)\"] }}",
              "rightValue": 45,
              "operator": {
                "type": "number",
                "operation": "gte"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -512,
        128
      ],
      "id": "c6d3b263-8e9a-455a-bd33-7f8a5a0b7023",
      "name": "45s length"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "2b0483ab-79c3-42f3-9fe0-e96e8e0e1a3f",
              "name": "fields[\"First Name\"]",
              "value": "={{ $('Edit Fields1').item.json.fields[\"First Name\"] }}",
              "type": "string"
            },
            {
              "id": "68e5fd4d-e927-41b8-b991-877a30a82c2e",
              "name": "fields[\"Last Name\"]",
              "value": "={{ $('Edit Fields1').item.json.fields[\"Last Name\"] }}",
              "type": "string"
            },
            {
              "id": "0614cd2c-de73-457d-9cee-f93d703c02d1",
              "name": "fields.Email",
              "value": "={{ $('Edit Fields1').item.json.fields.Email }}",
              "type": "string"
            },
            {
              "id": "27596fd5-ca72-48da-9eca-02d5edd96208",
              "name": "fields[\"Call Summary\"]",
              "value": "={{ $('Edit Fields1').item.json.fields[\"Call Summary\"] }}",
              "type": "string"
            },
            {
              "id": "3972631b-f76f-4d53-aa2b-25bbd75a5a2f",
              "name": "fields[\"Call Transcript\"]",
              "value": "={{ $('Edit Fields1').item.json.fields[\"Call Transcript\"] }}",
              "type": "string"
            },
            {
              "id": "847cc40e-5639-407c-a59b-3a6c31ff8732",
              "name": "Email",
              "value": "={{ $('Edit Fields1').item.json.Email }}",
              "type": "string"
            },
            {
              "id": "eb36d309-5ea8-4da6-9b8e-6a650b4fbf3b",
              "name": "First Name",
              "value": "={{ $('Edit Fields1').item.json[\"First Name\"] }}",
              "type": "string"
            },
            {
              "id": "2ca82292-39b1-43cc-97ca-4b3cee6340bc",
              "name": "Last Name",
              "value": "={{ $('Edit Fields1').item.json[\"Last Name\"] }}",
              "type": "string"
            },
            {
              "id": "da829b54-69a1-47cc-8560-2b31bc533783",
              "name": "Call Transcript",
              "value": "={{ $('Edit Fields1').item.json[\"Call Transcript\"] }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1184,
        32
      ],
      "id": "79b05fc7-e621-4736-b5ea-40a9f0283681",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "f6a9374e-c2c2-48fc-9c23-5c15367ddaa2",
              "name": "fields[\"First Name\"]",
              "value": "={{ $('New Conversation1').item.json.fields[\"First Name\"] }}",
              "type": "string"
            },
            {
              "id": "8613186a-e478-4d48-b7f6-c824b481ab0b",
              "name": "fields[\"Last Name\"]",
              "value": "={{ $('New Conversation1').item.json.fields[\"Last Name\"] }}",
              "type": "string"
            },
            {
              "id": "9fd3ae64-b126-4683-9528-a7844cecc464",
              "name": "fields.Email",
              "value": "={{ $('New Conversation1').item.json.fields.Email }}",
              "type": "string"
            },
            {
              "id": "8d8c45e2-e16a-415e-97f6-ec9f257ee11a",
              "name": "fields[\"Call Summary\"]",
              "value": "={{ $('New Conversation1').item.json.fields[\"Call Summary\"] }}",
              "type": "string"
            },
            {
              "id": "6be5813a-dc58-447a-b9ff-e19c28ae1798",
              "name": "fields[\"Call Transcript\"]",
              "value": "={{ $('New Conversation1').item.json.fields[\"Call Transcript\"] }}",
              "type": "string"
            },
            {
              "id": "fac072bc-3a1b-4c03-80e4-d068b36ec5c2",
              "name": "Email",
              "value": "={{ $('Search for new conv').item.json.Email }}",
              "type": "string"
            },
            {
              "id": "abeb6ada-a847-4ccb-b987-37e4ae4877ea",
              "name": "First Name",
              "value": "={{ $('Search for new conv').item.json[\"First Name\"] }}",
              "type": "string"
            },
            {
              "id": "7b3e5846-8258-41ed-97c3-bd46740e71a2",
              "name": "Last Name",
              "value": "={{ $('Search for new conv').item.json[\"Last Name\"] }}",
              "type": "string"
            },
            {
              "id": "d7b394a3-d0b2-4913-b4a3-9e1cc63c05a3",
              "name": "Call Transcript",
              "value": "={{ $('Search for new conv').item.json[\"Call Transcript\"] }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        160,
        128
      ],
      "id": "66a3094a-ebf3-4ca6-b43e-a36f911ea124",
      "name": "Edit Fields1"
    }
  ],
  "connections": {
    "New Conversation": {
      "main": [
        [
          {
            "node": "Get conversation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get conversation": {
      "main": [
        [
          {
            "node": "Search records1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search records1": {
      "main": [
        [
          {
            "node": "Aggregate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Vertex Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Get a record in Airtable": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "New Conversation1": {
      "main": [
        [
          {
            "node": "Get new conversation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Vertex Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Get a record in Airtable1": {
      "ai_tool": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate1": {
      "main": [
        [
          {
            "node": "AI Agent1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Vertex Chat Model2": {
      "ai_languageModel": [
        [
          {
            "node": "Create new single conv summary",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Create new conv summary",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get new conversation": {
      "main": [
        [
          {
            "node": "45s length",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search for new conv": {
      "main": [
        [
          {
            "node": "Search existing records",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search existing records": {
      "main": [
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create new single conv summary": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Vertex Chat Model3": {
      "ai_languageModel": [
        [
          {
            "node": "Conv history agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Conv history agent": {
      "main": [
        [
          {
            "node": "Create new conv summary1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "New Conversation2": {
      "main": [
        [
          {
            "node": "Get new conversation1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Aggregate3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Create new single conv summary1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "75s length1": {
      "main": [
        [
          {
            "node": "Search for new conv1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Vertex Chat Model4": {
      "ai_languageModel": [
        [
          {
            "node": "Create new single conv summary1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate3": {
      "main": [
        [
          {
            "node": "Conv history agent1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get new conversation1": {
      "main": [
        [
          {
            "node": "75s length1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search for new conv1": {
      "main": [
        [
          {
            "node": "Search existing records1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search existing records1": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create new single conv summary1": {
      "main": [
        [
          {
            "node": "Create new conv summary2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Vertex Chat Model5": {
      "ai_languageModel": [
        [
          {
            "node": "Conv history agent1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Conv history agent1": {
      "main": [
        [
          {
            "node": "Create new conv summary3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "45s length": {
      "main": [
        [
          {
            "node": "Search for new conv",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Conv history agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields1": {
      "main": [
        [
          {
            "node": "Create new single conv summary",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": {
    "node:New Conversation1": {
      "lastTimeChecked": "2025-11-09T10:29:37Z"
    },
    "node:Airtable Trigger": {
      "lastTimeChecked": "2025-10-27T12:25:02Z"
    }
  },
  "pinData": {
    "New Conversation1": [
      {
        "json": {
          "id": "recBTsGeXF984ns8A",
          "createdTime": "2025-10-29T01:28:38.000Z",
          "fields": {
            "Transcript ID": "conv_9201k8pq3a25f3ftzg7a2wtwtyxg",
            "Email": "iamandybatty@gmail.com",
            "First Name": "Andy",
            "Last Name": "Batty",
            "Date Last Updated": "2025-10-29T01:28:38.599Z",
            "Call Length (s)": 60,
            "Call Length (m)": 0,
            "Call Summary": "Andy asked Lenny (AI assistant) how long he had been working, correcting Lenny's initial miscalculation. Andy then mentioned he was going to bed soon. The conversation ended with Andy thanking Lenny. Lenny ended the call, also correcting Andy on Lenny's name.\n",
            "Call Cost": 0.0009238000000000002,
            "LLM Charge": 9,
            "Call Charge": 700,
            "Agent ID": "agent_0301k8ppxdaffegv4nmb1by40a1a",
            "Termination Reason": "end_call tool was called.",
            "Call Successful 11L?": "success",
            "Email recipient": "iamandybatty@gmail.com",
            "Call Transcript": "The conversation is between Andy (user) and Lenny (AI assistant). It comprises 13 turns over roughly one minute and focuses on Andys current time-of-day, how long he has been working, and his plan to go to bed soon. The agent opens with a friendly greeting and self-identification as Lenny and asks how it can help. Andy first states its 12.50am and Ive been on the go since 6am this morning, prompting the agent to compute and reply that Andy had been working for twelve hours and fifty minutes. Andy immediately corrects that he meant he started at 6am yesterday and it is now 12.50am, clarifying that the work period spans from 6am the previous day to 12:50am the current day. The agent apologizes for the earlier miscalculation and corrects the duration to eighteen hours and fifty minutes, characterizing it as certainly a marathon. Andy then says he will probably go to bed within the next half hour; the agent acknowledges and says it will make a note. Andy thanks the agent; shortly afterwards he says No, all good. Thanks, Mike, inadvertently using the name Mike despite the agents earlier self-identification as Lenny. The transcript shows two tool calls and two tool results initiated by the agent near the end of the exchange, but there is no explicit spoken response in the transcript correcting the Mike address after the users final utterance. The exchange includes short ASR trailing latencies on several user turns. Throughout the interaction the salient topics are time reporting, correction of the assistants initial time calculation, the users immediate plan to sleep soon, and a user misnaming of the assistant at the close of the conversation.\n\nFacts logged:\n1. Fact: Participants are Andy (user) and Lenny (AI assistant).\n2. Fact: Total turns in the transcript = 13.\n3. Fact: Agent self-identifies as Lenny at t=0s.\n4. Fact: Andys initial statement (t=8s): its 12.50am and Ive been on the go since 6am this morning. (ASR trailing latency recorded 0.115s for this turn.)\n5. Fact: Agents initial computation (t=22s): twelve hours and fifty minutes.\n6. Fact: Andys clarification (t=25s): he started at 6am yesterday and it is now 12.50am, changing the reference so the correct duration is longer. (ASR trailing latency recorded 0.179s for this turn.)\n7. Fact: Agents corrected computation (t=36s): eighteen hours and fifty minutes, with an apology for the earlier mistake.\n8. Fact: Andys plan (t=45s): he will probably go to bed in the next half hour. (ASR trailing latency recorded 0.237s for this turn.)\n9. Fact: Agent acknowledges and notes the users plan (t=52s).\n10. Fact: Andy expresses thanks twice: once at t=54s (Thanks, ASR trailing latency 0.177s) and again at t=54s (No, all good. Thanks, Mike. ASR trailing latency 0.105s), the latter containing a misnaming of the agent as Mike.\n11. Fact: The transcript shows two agent tool calls (at t=52s and t=56s) and two corresponding tool results; the transcript does not show an explicit spoken correction of the Mike misname after the users final utterance.\n12. Fact: The agent uses empathetic language about the long work period (Thats a long day! / Thats certainly a marathon!) and issues a direct apology for the calculation error.\n13. Fact: The final stated numeric duration of Andys work period, after correction, is 18 hours and 50 minutes (from 6:00am yesterday to 12:50am today).",
            "Created": "2025-10-29T01:28:38.000Z"
          }
        }
      }
    ]
  },
  "triggerCount": 1,
  "meta": {
    "templateCredsSetupCompleted": true
  }
}