{
  "name": "RAG Pipelines",
  "nodes": [
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "triggerOn": "specificFolder",
        "folderToWatch": {
          "__rl": true,
          "value": "1rP7a--_p5TVL0sl4PMWXpkdnLeyXAKmy",
          "mode": "list",
          "cachedResultName": "RAG",
          "cachedResultUrl": "https://drive.google.com/drive/folders/1rP7a--_p5TVL0sl4PMWXpkdnLeyXAKmy"
        },
        "event": "fileCreated",
        "options": {}
      },
      "type": "n8n-nodes-base.googleDriveTrigger",
      "typeVersion": 1,
      "position": [
        1152,
        496
      ],
      "id": "9b56e656-99a8-4dca-995c-08b74f945bb0",
      "name": "Google Drive Trigger"
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "={{ $json.id }}",
          "mode": "id"
        },
        "options": {
          "googleFileConversion": {
            "conversion": {
              "docsToFormat": "application/pdf"
            }
          }
        }
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        1360,
        496
      ],
      "id": "96bfd7da-304a-4d50-9c24-cdd64eadfa42",
      "name": "Download file"
    },
    {
      "parameters": {
        "mode": "insert",
        "tableName": {
          "__rl": true,
          "value": "documents",
          "mode": "list",
          "cachedResultName": "documents"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1.3,
      "position": [
        1568,
        496
      ],
      "id": "0bc00e75-f452-45c8-9bd3-85a7757147a8",
      "name": "Supabase Vector Store"
    },
    {
      "parameters": {
        "dataType": "binary",
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "fileName",
                "value": "={{ $json.name }}"
              },
              {
                "name": "date",
                "value": "={{ $now }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1.1,
      "position": [
        1696,
        640
      ],
      "id": "c917b5a7-5754-46c3-8f72-33b66523e49c",
      "name": "Default Data Loader"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        1520,
        640
      ],
      "id": "7e277c95-fc81-4d3b-9a81-e5e3b807a75d",
      "name": "Embeddings OpenAI"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        1328,
        96
      ],
      "id": "eb95341e-74b2-4b4c-a1c1-3874524e723e",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.3,
      "position": [
        1168,
        96
      ],
      "id": "a2bb547e-4f1a-4145-9204-e07ec81d8420",
      "name": "When chat message received",
      "webhookId": "60ef0174-4d66-458b-977d-3fcf4094f321"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        1312,
        240
      ],
      "id": "dcdbfb50-2da3-4dbf-b9d4-2363c1039223",
      "name": "OpenRouter Chat Model"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolDescription": "Use this to get information from your knowledge base.",
        "tableName": {
          "__rl": true,
          "value": "documents",
          "mode": "list",
          "cachedResultName": "documents"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1.3,
      "position": [
        1616,
        96
      ],
      "id": "397f214c-4c99-4465-b090-8ba4e067c232",
      "name": "Supabase Vector Store1"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        1664,
        240
      ],
      "id": "88aa740f-18b8-483f-9d3d-985d4df6a9df",
      "name": "Embeddings OpenAI1"
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "triggerOn": "specificFolder",
        "folderToWatch": {
          "__rl": true,
          "value": "1rP7a--_p5TVL0sl4PMWXpkdnLeyXAKmy",
          "mode": "list",
          "cachedResultName": "RAG",
          "cachedResultUrl": "https://drive.google.com/drive/folders/1rP7a--_p5TVL0sl4PMWXpkdnLeyXAKmy"
        },
        "event": "fileUpdated",
        "options": {}
      },
      "type": "n8n-nodes-base.googleDriveTrigger",
      "typeVersion": 1,
      "position": [
        1152,
        896
      ],
      "id": "6772c0f8-4b17-4922-a072-37990430e360",
      "name": "Google Drive Trigger1"
    },
    {
      "parameters": {
        "operation": "delete",
        "tableId": "documents",
        "filterType": "string",
        "filterString": "=metadata->>fileName=like.*{{ $json.name }}"
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        1296,
        896
      ],
      "id": "4241e7cf-778f-4f94-8c7b-3982a56e4d3e",
      "name": "Delete a row"
    },
    {
      "parameters": {
        "mode": "insert",
        "tableName": {
          "__rl": true,
          "value": "documents",
          "mode": "list",
          "cachedResultName": "documents"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1.3,
      "position": [
        1584,
        896
      ],
      "id": "4f845cff-5401-49b5-bf3a-c93bcb9f54a0",
      "name": "Supabase Vector Store2"
    },
    {
      "parameters": {
        "dataType": "binary",
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "fileName",
                "value": "={{ $('Google Drive Trigger1').item.json.name }}"
              },
              {
                "name": "date",
                "value": "={{ $now }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1.1,
      "position": [
        1696,
        1056
      ],
      "id": "9fb3bc6d-56a9-4b42-b18d-6a79bc7bbae9",
      "name": "Default Data Loader1"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        1520,
        1056
      ],
      "id": "73ebb202-eb26-4631-a96f-12990a69fa34",
      "name": "Embeddings OpenAI2"
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "={{ $('Google Drive Trigger1').item.json.id }}",
          "mode": "id"
        },
        "options": {
          "googleFileConversion": {
            "conversion": {
              "docsToFormat": "application/pdf"
            }
          }
        }
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        1440,
        896
      ],
      "id": "acfe2d1a-ebc8-44c7-96b9-4143bb15d141",
      "name": "Download file1",
      "executeOnce": true
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "triggerOn": "specificFolder",
        "folderToWatch": {
          "__rl": true,
          "value": "1r2Mquv0KFvwzVVsvTb3stzRugQdbDc72",
          "mode": "list",
          "cachedResultName": "Recycling Bin",
          "cachedResultUrl": "https://drive.google.com/drive/folders/1r2Mquv0KFvwzVVsvTb3stzRugQdbDc72"
        },
        "event": "fileCreated",
        "options": {}
      },
      "type": "n8n-nodes-base.googleDriveTrigger",
      "typeVersion": 1,
      "position": [
        1168,
        1344
      ],
      "id": "21d9012c-aea7-41c8-93f7-3cd2eed490b3",
      "name": "Google Drive Trigger2"
    },
    {
      "parameters": {
        "operation": "delete",
        "tableId": "documents",
        "filterType": "string",
        "filterString": "=metadata->>fileName=like.*{{ $json.name }}"
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        1360,
        1344
      ],
      "id": "5bc9ada5-8ee2-4d6e-9c7d-58721253086f",
      "name": "Delete a row1"
    },
    {
      "parameters": {
        "content": "# üõ†Ô∏è Setup Guide  \n**Author:** [Nate Herk](https://www.youtube.com/@nateherk)\n\nFollow these steps to get the n8n workflow system running smoothly:\n\n### ‚úÖ Step 1: Connect Your Google Drive Credentials  \nMake sure your **Google Drive trigger** is authorized and set to watch the appropriate folder for new file drops.\n\n### ‚úÖ Step 2: Connect Your Supabase Credentials  \nHook up your **Supabase** project so n8n can insert and manage vector data.\n\n### ‚úÖ Step 3: Connect Your Chat & Embeddings Models  \nUse [OpenRouter](https://openrouter.ai/) for flexible model access and [OpenAI](https://platform.openai.com/) for embedding generation.\n\n### ‚úÖ Step 4: Drop a Doc into the Trigger Folder  \nUpload a file into the folder being watched by **Pipeline 1** (new doc trigger). Confirm it‚Äôs inserted into Supabase and available to your agents.\n\n### ‚úÖ Step 5: Update the Doc  \nModify the same document. This should trigger **Pipeline 2 (update doc)**, which should:  \n- Remove old rows from Supabase  \n- Insert the new version cleanly\n\n### ‚úÖ Step 6: Move the File to the Recycling Bin  \nDrag the document into the \"recycling bin\" folder. This should trigger **Pipeline 3 (delete doc)** and clean up the corresponding vectors in Supabase.\n\n### üß™ Final Step: Test and Iterate  \nTry different document types and metadata formats. Make sure your agents can accurately retrieve and respond to your queries.\n",
        "height": 736,
        "width": 1040
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        0,
        0
      ],
      "id": "bcdd767d-8824-425c-ac8b-e882a13bf91d",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "# RAG Agent",
        "height": 384,
        "width": 880,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1056,
        0
      ],
      "id": "a36bb4ac-e2d7-4ea7-a35f-1c231e134cb2",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "# Pipeline 1 (Upload Doc)",
        "height": 384,
        "width": 880,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1056,
        400
      ],
      "id": "82ac85a5-3ff9-4a00-880c-7fd5932a0bd8",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "content": "# Pipeline 2 (Update Doc)",
        "height": 384,
        "width": 880,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1056,
        800
      ],
      "id": "1953695a-f3d9-4c74-a902-0c15ed7bd09f",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "content": "# Pipeline 3 (Delete Doc)",
        "height": 384,
        "width": 880,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1056,
        1200
      ],
      "id": "a00ae6f2-a0f7-4daf-9380-8022721ff6b0",
      "name": "Sticky Note4"
    }
  ],
  "connections": {
    "Google Drive Trigger": {
      "main": [
        [
          {
            "node": "Download file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download file": {
      "main": [
        [
          {
            "node": "Supabase Vector Store",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Default Data Loader": {
      "ai_document": [
        [
          {
            "node": "Supabase Vector Store",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI": {
      "ai_embedding": [
        [
          {
            "node": "Supabase Vector Store",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Supabase Vector Store1": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI1": {
      "ai_embedding": [
        [
          {
            "node": "Supabase Vector Store1",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Google Drive Trigger1": {
      "main": [
        [
          {
            "node": "Delete a row",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Default Data Loader1": {
      "ai_document": [
        [
          {
            "node": "Supabase Vector Store2",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI2": {
      "ai_embedding": [
        [
          {
            "node": "Supabase Vector Store2",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Delete a row": {
      "main": [
        [
          {
            "node": "Download file1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download file1": {
      "main": [
        [
          {
            "node": "Supabase Vector Store2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Drive Trigger2": {
      "main": [
        [
          {
            "node": "Delete a row1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "pinData": {},
  "triggerCount": 0,
  "meta": null
}