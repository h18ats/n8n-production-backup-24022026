{
  "name": "SAMPLE - NATE - Automated Web Scraping: email a CSV, save to Google Sheets & Microsoft Excel",
  "nodes": [
    {
      "parameters": {},
      "id": "4c765562-fd68-45b2-8544-c4b129f2c52a",
      "name": "When clicking \"Test workflow\"",
      "type": "n8n-nodes-base.manualTrigger",
      "position": [
        -100,
        400
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "fieldToSplitOut": "pads",
        "options": {}
      },
      "id": "26466e51-4f89-4c87-894e-bb8e218b6713",
      "name": "Split Out",
      "type": "n8n-nodes-base.splitOut",
      "position": [
        560,
        400
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "27d9687e-2050-4255-82ba-13c7096e3b7a",
      "name": "Convert to CSV File",
      "type": "n8n-nodes-base.convertToFile",
      "position": [
        1340,
        400
      ],
      "typeVersion": 1.1
    },
    {
      "parameters": {
        "content": "### You need to setup Microsoft Azure credentials with Microsoft Graph permissions.",
        "height": 184.90255200662574
      },
      "id": "f0e9925f-5ef1-4e6b-a09c-d3fa71942180",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1140,
        -40
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "### Unlike Google Sheets where we did not need to have a certain format, here we need to create the column headers, otherwise the appending to the sheet won't work.",
        "height": 183.1237982918667
      },
      "id": "5014be85-e916-4caa-ae37-0db6a697aaf7",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1420,
        -40
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "### For these steps to work you will need to have Drive, Sheets and Gmail APIs enabled in your Google Cloud Account",
        "height": 135.09744799337426
      },
      "id": "7a888cb5-43b1-407c-ae53-825f53d92e0e",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1540,
        600
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "operation": "extractHtmlContent",
        "extractionValues": {
          "values": [
            {
              "key": "books",
              "cssSelector": ".row > li",
              "returnValue": "html",
              "returnArray": true
            }
          ]
        },
        "options": {}
      },
      "id": "51feacf9-1911-467d-b84e-01a574db0323",
      "name": "Extract all books from the page",
      "type": "n8n-nodes-base.html",
      "position": [
        340,
        400
      ],
      "typeVersion": 1.2
    },
    {
      "parameters": {
        "sortFieldsUi": {
          "sortField": [
            {
              "fieldName": "price",
              "order": "descending"
            }
          ]
        },
        "options": {}
      },
      "id": "8d8cbd70-d694-4a53-8749-7c537e2a8f2d",
      "name": "Sort by price",
      "type": "n8n-nodes-base.sort",
      "position": [
        1000,
        400
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "operation": "extractHtmlContent",
        "dataPropertyName": "books",
        "extractionValues": {
          "values": [
            {
              "key": "title",
              "cssSelector": "h3 > a",
              "returnValue": "attribute",
              "attribute": "title"
            },
            {
              "key": "price",
              "cssSelector": ".price_color"
            }
          ]
        },
        "options": {}
      },
      "id": "adf0bc2c-89dd-43c8-af7b-ffd11eff7e9a",
      "name": "Extract individual book price",
      "type": "n8n-nodes-base.html",
      "position": [
        780,
        400
      ],
      "typeVersion": 1.2
    },
    {
      "parameters": {
        "resource": "worksheet",
        "operation": "append",
        "workbook": {
          "__rl": true,
          "mode": "id",
          "value": "=EA8A73F11507ECE9!24392"
        },
        "worksheet": {
          "__rl": true,
          "mode": "list",
          "value": "{00000000-0001-0000-0000-000000000000}",
          "cachedResultName": "Sheet1"
        },
        "dataMode": "autoMap",
        "options": {}
      },
      "id": "f4ff24d1-37b0-43dc-b5f8-7e2b8998ddfb",
      "name": "Save to Microsoft Excel 365",
      "type": "n8n-nodes-base.microsoftExcel",
      "position": [
        1340,
        180
      ],
      "typeVersion": 2.1,
      "disabled": true
    },
    {
      "parameters": {
        "sendTo": "constact@mihai.ltd",
        "subject": "bookstore csv",
        "message": "Hey, here's the scraped data from the online bookstore!",
        "options": {
          "attachmentsUi": {
            "attachmentsBinary": [
              {}
            ]
          }
        }
      },
      "id": "4d0392b7-32ab-4b0a-a5af-9029abccd3c1",
      "name": "Send CSV via e-mail",
      "type": "n8n-nodes-base.gmail",
      "position": [
        1560,
        440
      ],
      "typeVersion": 2.1,
      "webhookId": "cf83f2f6-0417-4907-b7d8-ed27767b3b5b",
      "credentials": {
        "gmailOAuth2": {
          "id": "7D8AIRVL8Y8Ycgo9",
          "name": "Gmail account"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "url": "https://www.ebcbrakes.com/",
        "options": {
          "allowUnauthorizedCerts": true
        }
      },
      "id": "e86a9236-ffea-42bd-84d1-50234b433c32",
      "name": "Fetch website content",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        120,
        400
      ],
      "typeVersion": 4.1
    },
    {
      "parameters": {
        "content": "## Automated Web Scraping: email a CSV, save to Google Sheets & Microsoft Excel\n\nSet-up steps:\n1. Change the website to scrape in the \"Fetch website content\" node\n2. Configure Microsoft Azure credentials with Microsoft Graph permissions (required for the Save to Microsoft Excel 365 node)\n3. Configure Google Cloud credentials with access to Google Drive, Google Sheets and Gmail APIs (the latter is required for the Send CSV via e-mail node).",
        "height": 297,
        "width": 579
      },
      "id": "c5230ecc-4c8b-4023-b55f-23138da472b2",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -120,
        -80
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "fieldToSplitOut": "books",
        "options": {}
      },
      "id": "213da72d-284e-43cd-92bc-f7a841c5c225",
      "name": "Split Out1",
      "type": "n8n-nodes-base.splitOut",
      "position": [
        560,
        -1180
      ],
      "typeVersion": 1,
      "disabled": true
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "6da66a19-e158-4b6f-a79c-c85fd75294e9",
      "name": "Convert to CSV File1",
      "type": "n8n-nodes-base.convertToFile",
      "position": [
        1340,
        -1180
      ],
      "typeVersion": 1.1,
      "disabled": true
    },
    {
      "parameters": {
        "content": "### You need to setup Microsoft Azure credentials with Microsoft Graph permissions.",
        "height": 184.90255200662574
      },
      "id": "0c78f529-5c5f-4104-b21e-83070f60b550",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1140,
        -1620
      ],
      "typeVersion": 1,
      "disabled": true
    },
    {
      "parameters": {
        "content": "### Unlike Google Sheets where we did not need to have a certain format, here we need to create the column headers, otherwise the appending to the sheet won't work.",
        "height": 183.1237982918667
      },
      "id": "0706ef9f-894e-443c-98cf-dea188117f4a",
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1420,
        -1620
      ],
      "typeVersion": 1,
      "disabled": true
    },
    {
      "parameters": {
        "content": "### For these steps to work you will need to have Drive, Sheets and Gmail APIs enabled in your Google Cloud Account",
        "height": 135.09744799337426
      },
      "id": "8dfe24b2-4278-4e77-b890-92bb63a9a2dd",
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1540,
        -980
      ],
      "typeVersion": 1,
      "disabled": true
    },
    {
      "parameters": {
        "operation": "extractHtmlContent",
        "extractionValues": {
          "values": [
            {
              "key": "books",
              "cssSelector": ".row > li",
              "returnValue": "html",
              "returnArray": true
            }
          ]
        },
        "options": {}
      },
      "id": "28607d2c-a4ce-4c2a-a94f-329fe76def84",
      "name": "Extract all books from the page1",
      "type": "n8n-nodes-base.html",
      "position": [
        340,
        -1180
      ],
      "typeVersion": 1.2,
      "disabled": true
    },
    {
      "parameters": {
        "sortFieldsUi": {
          "sortField": [
            {
              "fieldName": "price",
              "order": "descending"
            }
          ]
        },
        "options": {}
      },
      "id": "07b993b9-cf7c-4306-91c0-0418b79b623b",
      "name": "Sort by price1",
      "type": "n8n-nodes-base.sort",
      "position": [
        1000,
        -1180
      ],
      "typeVersion": 1,
      "disabled": true
    },
    {
      "parameters": {
        "operation": "extractHtmlContent",
        "dataPropertyName": "books",
        "extractionValues": {
          "values": [
            {
              "key": "title",
              "cssSelector": "h3 > a",
              "returnValue": "attribute",
              "attribute": "title"
            },
            {
              "key": "price",
              "cssSelector": ".price_color"
            }
          ]
        },
        "options": {}
      },
      "id": "c445fef7-633c-4b47-8f77-9c8283d00651",
      "name": "Extract individual book price1",
      "type": "n8n-nodes-base.html",
      "position": [
        780,
        -1180
      ],
      "typeVersion": 1.2,
      "disabled": true
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "mode": "list",
          "value": "1zyiRT7iIlfzZiskC9vDVoAFnW_UNMVXX0-ESVU1yYxY",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1zyiRT7iIlfzZiskC9vDVoAFnW_UNMVXX0-ESVU1yYxY/edit?usp=drivesdk",
          "cachedResultName": "Scraped Data"
        },
        "sheetName": {
          "__rl": true,
          "mode": "list",
          "value": "gid=0",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1zyiRT7iIlfzZiskC9vDVoAFnW_UNMVXX0-ESVU1yYxY/edit#gid=0",
          "cachedResultName": "Sheet1"
        },
        "columns": {
          "value": {},
          "schema": [
            {
              "id": "title",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "title",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "price",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "price",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "autoMapInputData",
          "matchingColumns": []
        },
        "options": {}
      },
      "id": "9a6b0046-6981-4625-9722-401bf515608a",
      "name": "Save to Google Sheets1",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        1340,
        -960
      ],
      "typeVersion": 4.2,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "ideYdPgaT4pRzHvx",
          "name": "Google Sheets account"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "resource": "worksheet",
        "operation": "append",
        "workbook": {
          "__rl": true,
          "mode": "id",
          "value": "=EA8A73F11507ECE9!24392"
        },
        "worksheet": {
          "__rl": true,
          "mode": "list",
          "value": "{00000000-0001-0000-0000-000000000000}",
          "cachedResultName": "Sheet1"
        },
        "dataMode": "autoMap",
        "options": {}
      },
      "id": "741e92af-a81c-448a-bc4a-0af3ba202ad3",
      "name": "Save to Microsoft Excel ",
      "type": "n8n-nodes-base.microsoftExcel",
      "position": [
        1340,
        -1400
      ],
      "typeVersion": 2.1,
      "disabled": true
    },
    {
      "parameters": {
        "sendTo": "constact@mihai.ltd",
        "subject": "bookstore csv",
        "message": "Hey, here's the scraped data from the online bookstore!",
        "options": {
          "attachmentsUi": {
            "attachmentsBinary": [
              {}
            ]
          }
        }
      },
      "id": "f68dd041-1cb3-40f8-8dc9-d00cd502b319",
      "name": "Send CSV via e-mail1",
      "type": "n8n-nodes-base.gmail",
      "position": [
        1560,
        -1180
      ],
      "typeVersion": 2.1,
      "webhookId": "cf83f2f6-0417-4907-b7d8-ed27767b3b5b",
      "disabled": true
    },
    {
      "parameters": {
        "url": "http://books.toscrape.com",
        "options": {
          "allowUnauthorizedCerts": true
        }
      },
      "id": "b12f5193-2ae0-46ef-a29e-aa2990917422",
      "name": "Fetch website content1",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        120,
        -1180
      ],
      "typeVersion": 4.1,
      "disabled": true
    },
    {
      "parameters": {
        "content": "## Automated Web Scraping: email a CSV, save to Google Sheets & Microsoft Excel\n\nSet-up steps:\n1. Change the website to scrape in the \"Fetch website content\" node\n2. Configure Microsoft Azure credentials with Microsoft Graph permissions (required for the Save to Microsoft Excel 365 node)\n3. Configure Google Cloud credentials with access to Google Drive, Google Sheets and Gmail APIs (the latter is required for the Send CSV via e-mail node).",
        "height": 297,
        "width": 579
      },
      "id": "449f2779-c58e-4b2a-a40e-17e9a3bb40f0",
      "name": "Sticky Note7",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -120,
        -1660
      ],
      "typeVersion": 1,
      "disabled": true
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1NCRzZ3UqaX0AdTZlMlio5re22R_5f7t4Iie0jGtvZu8",
          "mode": "list",
          "cachedResultName": "Automated Web Scraping: email a CSV",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1NCRzZ3UqaX0AdTZlMlio5re22R_5f7t4Iie0jGtvZu8/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Sheet1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1NCRzZ3UqaX0AdTZlMlio5re22R_5f7t4Iie0jGtvZu8/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [
            {
              "id": "1",
              "displayName": "1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "2",
              "displayName": "2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "3",
              "displayName": "3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "4",
              "displayName": "4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "5",
              "displayName": "5",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "6",
              "displayName": "6",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "7",
              "displayName": "7",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "8",
              "displayName": "8",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "9",
              "displayName": "9",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "10",
              "displayName": "10",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "11",
              "displayName": "11",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "12",
              "displayName": "12",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "13",
              "displayName": "13",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "14",
              "displayName": "14",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "15",
              "displayName": "15",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "16",
              "displayName": "16",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "17",
              "displayName": "17",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "18",
              "displayName": "18",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "19",
              "displayName": "19",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "20",
              "displayName": "20",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "0ce5d669-e8db-42ff-94ea-00cfc2bf413d",
      "name": "Save to Google Sheets2",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        1320,
        620
      ],
      "typeVersion": 4.2,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "ideYdPgaT4pRzHvx",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "toRecipients": "andy@legalengine.co.uk",
        "subject": "=bookstore csv",
        "bodyContent": "=Hey, here's the scraped data from the online bookstore!",
        "additionalFields": {
          "attachments": {
            "attachments": [
              {
                "binaryPropertyName": "data"
              }
            ]
          }
        }
      },
      "type": "n8n-nodes-base.microsoftOutlook",
      "typeVersion": 2,
      "position": [
        1560,
        200
      ],
      "id": "d9a57722-574e-4018-b8d8-d0fb92f8be45",
      "name": "Email with CSV",
      "webhookId": "aac76629-ddf0-455a-b7bc-456bc56a27d9",
      "credentials": {
        "microsoftOutlookOAuth2Api": {
          "id": "APa28clvTTmmzH55",
          "name": "Microsoft Outlook account 2"
        }
      }
    }
  ],
  "connections": {
    "When clicking \"Test workflow\"": {
      "main": [
        [
          {
            "node": "Fetch website content",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out": {
      "main": [
        [
          {
            "node": "Extract individual book price",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert to CSV File": {
      "main": [
        [
          {
            "node": "Send CSV via e-mail",
            "type": "main",
            "index": 0
          },
          {
            "node": "Email with CSV",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract all books from the page": {
      "main": [
        [
          {
            "node": "Split Out",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Sort by price": {
      "main": [
        [
          {
            "node": "Save to Microsoft Excel 365",
            "type": "main",
            "index": 0
          },
          {
            "node": "Convert to CSV File",
            "type": "main",
            "index": 0
          },
          {
            "node": "Save to Google Sheets2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract individual book price": {
      "main": [
        [
          {
            "node": "Sort by price",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch website content": {
      "main": [
        [
          {
            "node": "Extract all books from the page",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out1": {
      "main": [
        [
          {
            "node": "Extract individual book price1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert to CSV File1": {
      "main": [
        [
          {
            "node": "Send CSV via e-mail1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract all books from the page1": {
      "main": [
        [
          {
            "node": "Split Out1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Sort by price1": {
      "main": [
        [
          {
            "node": "Save to Microsoft Excel ",
            "type": "main",
            "index": 0
          },
          {
            "node": "Convert to CSV File1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Save to Google Sheets1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract individual book price1": {
      "main": [
        [
          {
            "node": "Sort by price1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch website content1": {
      "main": [
        [
          {
            "node": "Extract all books from the page1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "pinData": {},
  "triggerCount": 0,
  "meta": null
}