{
  "name": "Create Leonard Clone with PP serach",
  "nodes": [
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.elevenlabs.io/v1/convai/agents/create",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "xi-api-key",
              "value": "sk_cf2f6abdf8d17c22e76236f81c5c1466ffb50831ea37eae4"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"agent_id\": \"tG9uM0Gz6OeuPuR8B123\",\n    \"name\": \"{{ $('Notion Upload Page').item.json.name }}'s AI Agent\",\n    \"conversation_config\": {\n        \"asr\": {\n            \"quality\": \"high\",\n            \"provider\": \"elevenlabs\",\n            \"user_input_audio_format\": \"pcm_16000\",\n            \"keywords\": []\n        },\n        \"turn\": {\n            \"turn_timeout\": 7.0,\n            \"silence_end_call_timeout\": 60.0,\n            \"mode\": \"turn\"\n        },\n        \"tts\": {\n            \"model_id\": \"eleven_flash_v2\",\n            \"voice_id\": \"AwP2bjcqrSky0yiDhZSe\",\n            \"agent_output_audio_format\": \"pcm_16000\",\n            \"optimize_streaming_latency\": 4,\n            \"stability\": 0.45,\n            \"speed\": 1.0,\n            \"similarity_boost\": 0.5,\n            \"pronunciation_dictionary_locators\": []\n        },\n        \"conversation\": {\n            \"max_duration_seconds\": 750,\n            \"client_events\": [\n                \"audio\",\n                \"interruption\",\n                \"user_transcript\",\n                \"agent_response\",\n                \"agent_response_correction\"\n            ]\n        },\n        \"language_presets\": {},\n        \"agent\": {\n            \"first_message\": \"Hi there {{ $('Code').item.json.firstName }},  I'm Leonard from Legal Engine. I'm going to show you how, by harnessing the power of voice and AI, I can help to take the pain out of creating a professional bio that can be used for both directory submissions and other BD activities. If you're chatting with me on a mobile device you may need to ensure the device doesn't go into standby as it may interrupt our conversation. If we could start with you sharing, a high level of what you want me to include in the bio, I can then show you what I'm capable of. Over to you {{ $('Code').item.json.firstName }}…\",\n            \"language\": \"en\",\n            \"dynamic_variables\": {\n                \"dynamic_variable_placeholders\": {\n                    \"user_name\": \"Andy\"\n                }\n            },\n            \"prompt\": {\n                \"prompt\": \"You are a business development manager for a top tier UK law firm. Use what you have within your knowledge base to help to complete a bio for the caller that will feature as part of their submission to Chambers and Legal 500. You can be jovial but professional. Once the caller states their high level guidance on what needs to go in the bio, use the knowledge base and what the caller has said to provide the caller with a 200 word bio in UK English. Use this as the basis for the bio and ask the user if it needs amending or changing.\",\n\"llm\": \"gemini-2.0-flash-001\",\n                \"temperature\": 0.6,\n                \"max_tokens\": -1,\n                \"tools\": [\n                    {\n                        \"id\": \"EUv1berotGH2ACIu2O65\",\n                        \"type\": \"system\",\n                        \"name\": \"language_detection\",\n                        \"description\": \"\",\n                        \"params\": {\n                            \"system_tool_type\": \"language_detection\"\n                        }\n                    },\n                    {\n                        \"id\": \"zLmU2CTKXCq9MOzvaSLb\",\n                        \"type\": \"webhook\",\n                        \"name\": \"save_client\",\n                        \"description\": \"Use this tool to save the client name for a matter once it is known\",\n                        \"api_schema\": {\n                            \"url\": \"https://leonard-dev.app.n8n.cloud/webhook/testcrm\",\n                            \"method\": \"POST\",\n                            \"path_params_schema\": {},\n                            \"query_params_schema\": null,\n                            \"request_body_schema\": {\n                                \"type\": \"object\",\n                                \"properties\": {\n                                    \"client\": {\n                                        \"type\": \"string\",\n                                        \"description\": \"Establish the client's name \",\n                                        \"dynamic_variable\": \"\",\n                                        \"constant_value\": \"\"\n                                    },\n                                    \"user_email\": {\n                                        \"type\": \"string\",\n                                        \"description\": \"\",\n                                        \"dynamic_variable\": \"user_email\",\n                                        \"constant_value\": \"\"\n                                    },\n                                    \"user_name\": {\n                                        \"type\": \"string\",\n                                        \"description\": \"\",\n                                        \"dynamic_variable\": \"user_name\",\n                                        \"constant_value\": \"\"\n                                    }\n                                },\n                                \"required\": [\n                                    \"client\",\n                                    \"user_email\",\n                                    \"user_name\"\n                                ],\n                                \"description\": \"Get the client name, first name and other personal details ready to save\"\n                            },\n                            \"request_headers\": {}\n                        },\n                        \"dynamic_variables\": {\n                            \"dynamic_variable_placeholders\": {\n                                \"user_email\": \"andy@legalengine.co.uk\",\n                                \"user_name\": \"Andy\"\n                            }\n                        }\n                    },\n                    {\n                        \"id\": \"lfbwRtpGj7SwzaH8LaQK\",\n                        \"type\": \"webhook\",\n                        \"name\": \"send_summary\",\n                        \"description\": \"Use this tool to send the user the summary of a matter once they approve that it is correct. \",\n                        \"api_schema\": {\n                            \"url\": \"https://leonard-dev.app.n8n.cloud/webhook/testdemo\",\n                            \"method\": \"POST\",\n                            \"path_params_schema\": {},\n                            \"query_params_schema\": null,\n                            \"request_body_schema\": {\n                                \"type\": \"object\",\n                                \"properties\": {\n                                    \"user_email\": {\n                                        \"type\": \"string\",\n                                        \"description\": \"\",\n                                        \"dynamic_variable\": \"user_email\",\n                                        \"constant_value\": \"\"\n                                    },\n                                    \"summary\": {\n                                        \"type\": \"string\",\n                                        \"description\": \"summary of matter description in UK English, not US English\",\n                                        \"dynamic_variable\": \"\",\n                                        \"constant_value\": \"\"\n                                    },\n                                    \"user_name\": {\n                                        \"type\": \"string\",\n                                        \"description\": \"\",\n                                        \"dynamic_variable\": \"user_name\",\n                                        \"constant_value\": \"\"\n                                    },\n                                    \"transcript\": {\n                                        \"type\": \"string\",\n                                        \"description\": \"A full transcript of the user's conversation with the agent until this point, in UK English, not US English\",\n                                        \"dynamic_variable\": \"\",\n                                        \"constant_value\": \"\"\n                                    }\n                                },\n                                \"required\": [\n                                    \"user_email\",\n                                    \"summary\",\n                                    \"user_name\",\n                                    \"transcript\"\n                                ],\n                                \"description\": \"Ask the user if the matter summary that you gave them is correct, if okay to send, trigger this action.\"\n                            },\n                            \"request_headers\": {}\n                        },\n                        \"dynamic_variables\": {\n                            \"dynamic_variable_placeholders\": {\n                                \"user_email\": \"andy@legalengine.co.uk\",\n                                \"user_name\": \"Andy\"\n                            }\n                        }\n                    },\n                    {\n                        \"id\": \"fEL96Xn1nkQZ2J39JmtN\",\n                        \"type\": \"system\",\n                        \"name\": \"end_call\",\n                        \"description\": \"\",\n                        \"params\": {\n                            \"system_tool_type\": \"end_call\"\n                        }\n                    }\n                ],\n                \"tool_ids\": [\n                    \"EUv1berotGH2ACIu2O65\",\n                    \"zLmU2CTKXCq9MOzvaSLb\",\n                    \"lfbwRtpGj7SwzaH8LaQK\",\n                    \"fEL96Xn1nkQZ2J39JmtN\"\n                ],\n                \"knowledge_base\": [\n                    {\n                        \"type\": \"url\",\n                        \"name\": \"2025.03 facets 1 to 6 - laws - work types - sectors - participants - connectors - information assets - noslegal 3.0 - Microsoft.xlsx\",\n                        \"id\": \"ejv14Dbmoc3KyCyFO19K\",\n                        \"usage_mode\": \"auto\"\n                    },\n                    {\n                        \"type\": \"url\",\n                        \"name\": \"{{ $('Notion Upload Page').item.json.name }} - Personal Profile and Company Info\",\n                        \"id\": \"{{ $('Create KB').item.json.id }}\",\n                        \"usage_mode\": \"prompt\"\n                    },\n                    {\n                        \"type\": \"url\",\n                        \"name\": \"taxonomy/2025.03 v3 noslegal release/2025.03 guide - noslegal 3.0.pdf at main · noslegal/taxonomy\",\n                        \"id\": \"asdugn4RGhF5gvo638Mz\",\n                        \"usage_mode\": \"auto\"\n                    },\n                    {\n                        \"type\": \"url\",\n                        \"name\": \"GitHub - noslegal/taxonomy: noslegal taxonomy facets and release notes\",\n                        \"id\": \"WTSeALM0hCdp3JOAQkh7\",\n                        \"usage_mode\": \"auto\"\n                    },\n                    {\n                        \"type\": \"text\",\n                        \"name\": \"Legal500 Instructions\",\n                        \"id\": \"Y47AunKPNxeDkf6ZXHrA\",\n                        \"usage_mode\": \"auto\"\n                    }\n                ],\n                \"custom_llm\": null,\n                \"ignore_default_personality\": false,\n                \"rag\": {\n                    \"enabled\": true,\n                    \"embedding_model\": \"e5_mistral_7b_instruct\",\n                    \"max_vector_distance\": 0.6,\n                    \"max_documents_length\": 50000\n                }\n            }\n        }\n    },\n    \"metadata\": {\n        \"created_at_unix_secs\": 1745903685\n    },\n    \"platform_settings\": {\n        \"auth\": {\n            \"enable_auth\": false,\n            \"allowlist\": [],\n            \"shareable_token\": null\n        },\n        \"evaluation\": {\n            \"criteria\": []\n        },\n        \"widget\": {\n            \"variant\": \"full\",\n            \"expandable\": \"never\",\n            \"avatar\": {\n                \"type\": \"orb\",\n                \"color_1\": \"#2792DC\",\n                \"color_2\": \"#9CE6E6\"\n            },\n            \"feedback_mode\": \"during\",\n            \"bg_color\": \"#ffffff\",\n            \"text_color\": \"#000000\",\n            \"btn_color\": \"#000000\",\n            \"btn_text_color\": \"#ffffff\",\n            \"border_color\": \"#e1e1e1\",\n            \"focus_color\": \"#000000\",\n            \"border_radius\": null,\n            \"btn_radius\": null,\n            \"action_text\": null,\n            \"start_call_text\": null,\n            \"end_call_text\": null,\n            \"expand_text\": null,\n            \"listening_text\": null,\n            \"speaking_text\": null,\n            \"shareable_page_text\": null,\n            \"shareable_page_show_terms\": true,\n            \"terms_text\": \"#### Terms and conditions\\n\\nBy clicking \\\"Agree,\\\" and each time I interact with this AI agent, I consent to the recording, storage, and sharing of my communications with third-party service providers, and as described in the Privacy Policy.\\nIf you do not wish to have your conversations recorded, please refrain from using this service.\",\n            \"terms_html\": \"<h4>Terms and conditions</h4>\\n<p>By clicking &quot;Agree,&quot; and each time I interact with this AI agent, I consent to the recording, storage, and sharing of my communications with third-party service providers, and as described in the Privacy Policy.\\nIf you do not wish to have your conversations recorded, please refrain from using this service.</p>\\n\",\n            \"terms_key\": null,\n            \"show_avatar_when_collapsed\": true,\n            \"disable_banner\": false,\n            \"mic_muting_enabled\": false,\n            \"language_selector\": false,\n            \"custom_avatar_path\": null\n        },\n        \"data_collection\": {},\n        \"overrides\": {\n            \"conversation_config_override\": {\n                \"agent\": {\n                    \"prompt\": {\n                        \"prompt\": false\n                    },\n                    \"first_message\": false,\n                    \"language\": true\n                },\n                \"tts\": {\n                    \"voice_id\": false\n                }\n            },\n            \"custom_llm_extra_body\": false,\n            \"enable_conversation_initiation_client_data_from_webhook\": false\n        },\n        \"call_limits\": {\n            \"agent_concurrency_limit\": -1,\n            \"daily_limit\": 100000\n        },\n        \"ban\": null,\n        \"privacy\": {\n            \"record_voice\": true,\n            \"retention_days\": 730,\n            \"delete_transcript_and_pii\": true,\n            \"delete_audio\": true,\n            \"apply_to_existing_conversations\": false\n        },\n        \"workspace_overrides\": {\n            \"conversation_initiation_client_data_webhook\": null,\n            \"webhooks\": {\n                \"post_call_webhook_id\": null\n            }\n        },\n        \"safety\": {\n            \"is_blocked_ivc\": false,\n            \"is_blocked_non_ivc\": false,\n            \"ignore_safety_evaluation\": false\n        }\n    },\n    \"phone_numbers\": [],\n    \"access_info\": {\n        \"is_creator\": true,\n        \"creator_name\": \"Leonard\",\n        \"creator_email\": \"leonard@legalengine.co.uk\",\n        \"role\": \"admin\"\n    },\n    \"categories\": []\n}\n\n\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2340,
        -400
      ],
      "id": "f1a068eb-eea8-4ec3-b1b4-64b5649b4273",
      "name": "Create Agent"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "8256478d-7f94-41e2-945a-39531c071cfe",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -180,
        -200
      ],
      "id": "e4eb5620-057c-4722-9c5a-e0dc3d52c4a9",
      "name": "Webhook",
      "webhookId": "8256478d-7f94-41e2-945a-39531c071cfe"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.dateTime",
      "typeVersion": 2,
      "position": [
        40,
        -200
      ],
      "id": "a26978af-3d27-4103-802a-d82615e23477",
      "name": "Date & Time"
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "f7100e1f-6821-42df-90fd-2f430bfb6674",
      "name": "OpenAI Model1",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1,
      "position": [
        740,
        20
      ],
      "credentials": {
        "openAiApi": {
          "id": "LldOhLNBReShSMkE",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.perplexity.ai/chat/completions",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"model\": \"sonar\",\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"You are an expert researcher who uses deep research for professional services and law firms in order to provide lawyers, legal firm partners, business development teams at law firms and marketing departments at law firms with incredibly comprehensive and accurate publicly available information.\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"I have the following information; Name={{ $json.fullName }}, Email={{ $json.email }}, Company={{ $json.domain }}. Please provide an accurate possible professional brief for a senior manager using the sources above, find me all information that relates to the work that the user and their firm have done that may have involved the user and/or is related to the areas of specialism that the user has according to their publicly available research and company bio when looking at work that is related to the user it may be helpful to looking at the sector, the practice area and the office for the user as well as their Relevant experience, Publications and insights, News and client work, Professional bodies, Awards and citations and Career and qualifications. \"\n    }\n  ],\n  \"max_tokens\": 1200,\n  \"temperature\": 0.5\n}",
        "options": {}
      },
      "id": "36ebc43c-0825-4e24-8a3b-5c8ab89e1952",
      "name": "Perplexity Firm Research",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        480,
        -200
      ],
      "typeVersion": 4.2,
      "credentials": {
        "httpHeaderAuth": {
          "id": "Ok9KPJP4UMw6OLgP",
          "name": "Unnamed credential"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const email = $('Webhook').first().json.body.user_email; // or use the correct field name from your webhook\nconst [fullNamePart, domain] = email.split(\"@\");\n\nlet firstName = \"\";\nlet lastName = \"\";\n\n// Try splitting by dot or fallback to full name as first name\nif (fullNamePart.includes(\".\")) {\n  [firstName, lastName] = fullNamePart.split(\".\");\n} else {\n  firstName = fullNamePart;\n}\n\nfirstName = firstName.charAt(0).toUpperCase() + firstName.slice(1);\nlastName = lastName ? lastName.charAt(0).toUpperCase() + lastName.slice(1) : \"\";\nconst fullName = lastName ? `${firstName} ${lastName}` : firstName;\n\nreturn [\n  {\n    json: {\n      email,\n      firstName,\n      lastName,\n      fullName,\n      domain,\n    },\n  },\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        260,
        -200
      ],
      "id": "8ba21017-7503-45bb-b941-f169bf403241",
      "name": "Code"
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "ad28ac5d-cde9-44c8-b06e-431efc221954",
      "name": "OpenAI Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1,
      "position": [
        1120,
        20
      ],
      "credentials": {
        "openAiApi": {
          "id": "LldOhLNBReShSMkE",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=You are an expert business development researcher, a world leader in helping law and professional service firms and companies grow. Using the following information available, which comes from a perplexity search of similar legal matters to the one originally ingested.\n\nI want you to write a robustly compiled, comprehensive and verbose list of Subject Areas, Industries and Matters that you've found that are related to the user. \n\nDo not make up information, but do use all information in full.\n\nBe sure to write in UK English and NOT US English and make sure the output is a maximum of 1500 characters. \n\nINPUT:\nThe content is  here: {{ $('Perplexity Firm Research').item.json.choices[0].message.content }}\nHere is the date and time: {{ $now }}",
        "options": {
          "systemMessage": "=You are an expert business development researcher, a world leader in helping law and professional service firms and companies grow. Using the following information available, which comes from a perplexity search of similar legal matters to the one originally ingested.\n\nI want you to write a robustly compiled, comprehensive and verbose list of Subject Areas, Industries and Matters that you've found that are related to the user. \n\nDo not make up information, but do use all information in full.\n\nBe sure to write in UK English and NOT US English and make sure the output is a maximum of 1500 characters. \n\nINPUT:\nThe content is  here: {{ $('Perplexity Firm Research').item.json.choices[0].message.content }}\nHere is the date and time: {{ $now }}"
        }
      },
      "id": "1218f5af-f7f7-4156-97d9-411e9f097682",
      "name": "Individual Info",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.7,
      "position": [
        700,
        -200
      ]
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=You are an expert business development researcher, a world leader in helping law and professional service firms and companies grow. Using the following information available, which comes from a perplexity search of similar legal matters to the one originally ingested.\n\nI want you to write a robustly compiled, comprehensive and verbose list of Subject Areas, Industries and Matters that you've found that are related to the firm and all awards, ESG notes and anything that would be helpful to show a throrough understanding of the firm. \n\nDo not make up information, but do use all information in full.\n\nBe sure to write in UK English and NOT US English and make sure the output is a maximum of 1500 characters. \nKeep length to a maximum of 1500 Characters.\n\nINPUT:\nThe content is  here: {{ $('Perplexity Firm Research').item.json.choices[0].message.content }}\nHere is the date and time: {{ $now }}",
        "options": {
          "systemMessage": "=You are an expert business development researcher, a world leader in helping law and professional service firms and companies grow. Using the following information available, which comes from a perplexity search of similar legal matters to the one originally ingested.\n\nI want you to write a robustly compiled, comprehensive and verbose list of Subject Areas, Industries and Matters that you've found that are related to the user. \n\nDo not make up information, but do use all information in full.\n\nBe sure to write in UK English and NOT US English and make sure the output is a maximum of 1500 characters. \nKeep length to a maximum of 1500 Characters.\n\nINPUT:\nThe content is  here: {{ $('Perplexity Firm Research').item.json.choices[0].message.content }}\nHere is the date and time: {{ $now }}"
        }
      },
      "id": "544434b3-cc6c-4358-a58a-423310ef04be",
      "name": "Company info",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.7,
      "position": [
        1080,
        -200
      ]
    },
    {
      "parameters": {
        "resource": "databasePage",
        "databaseId": {
          "__rl": true,
          "value": "1ea69e60-0837-809f-83cd-dc13c923af60",
          "mode": "list",
          "cachedResultName": "1ea69e60-0837-809f-83cd-dc13c923af60",
          "cachedResultUrl": "https://www.notion.so/1ea69e600837809f83cddc13c923af60"
        },
        "title": "TonyTest",
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Email|title",
              "title": "={{ $('Code').item.json.email }}"
            },
            {
              "key": "Company|rich_text",
              "textContent": "={{ $('Code').item.json.domain }}"
            },
            {
              "key": "FN|rich_text",
              "textContent": "={{ $('Code').item.json.firstName }}"
            },
            {
              "key": "SN|rich_text",
              "textContent": "={{ $('Code').item.json.lastName }}"
            },
            {
              "key": "C Details|rich_text",
              "textContent": "={{ $json.output }}"
            },
            {
              "key": "P Details|rich_text",
              "textContent": "={{ $('Individual Info').item.json.output }}"
            },
            {
              "key": "Name|rich_text",
              "textContent": "={{ $('Code').item.json.fullName }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        1460,
        -200
      ],
      "id": "8d0c816e-fd23-4544-bad8-5edf84d0c781",
      "name": "Notion",
      "credentials": {
        "notionApi": {
          "id": "F6UQEs6NhRbwsx9v",
          "name": "Notion account"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "resource": "database",
        "databaseId": {
          "__rl": true,
          "value": "1ea69e60-0837-809f-83cd-dc13c923af60",
          "mode": "id"
        }
      },
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        1680,
        -200
      ],
      "id": "7042867f-c46a-4dcb-8397-ee064fa93863",
      "name": "Notion1",
      "credentials": {
        "notionApi": {
          "id": "F6UQEs6NhRbwsx9v",
          "name": "Notion account"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "get",
        "pageId": {
          "__rl": true,
          "value": "={{ $('Notion').item.json.url }}",
          "mode": "url"
        }
      },
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        1900,
        -200
      ],
      "id": "c412c8c8-55bf-4af2-bb01-40d75d288747",
      "name": "Notion2",
      "credentials": {
        "notionApi": {
          "id": "F6UQEs6NhRbwsx9v",
          "name": "Notion account"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.elevenlabs.io/v1/convai/agents/create",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "xi-api-key",
              "value": "sk_cf2f6abdf8d17c22e76236f81c5c1466ffb50831ea37eae4"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "=\n{\n    \"url\": \"{{ $json.url }}\"\n\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2200,
        -200
      ],
      "id": "b298f73b-0f8a-4341-8ff0-455ab5262a43",
      "name": "Create Agent1",
      "disabled": true
    },
    {
      "parameters": {
        "jsCode": "const content = $input.first().json.output;\nreturn [\n  {\n    binary: {\n      data: {\n        data: Buffer.from(content, \"utf8\").toString(\"base64\"),\n        mimeType: \"text/plain\",\n        fileName: \"output.txt\",\n      },\n    },\n  },\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1460,
        20
      ],
      "id": "0d26a8ab-f15d-4ad7-b62b-ec7b893ee1c3",
      "name": "Code1",
      "disabled": true
    },
    {
      "parameters": {
        "jsCode": "const content = $input.first().json.output;\nreturn [\n  {\n    binary: {\n      data: {\n        data: Buffer.from(content, \"utf8\").toString(\"base64\"),\n        mimeType: \"text/plain\",\n        fileName: \"output.txt\",\n      },\n    },\n  },\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1460,
        220
      ],
      "id": "d410df60-45d0-48fe-806c-4346ef735f11",
      "name": "Code2",
      "disabled": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.elevenlabs.io/v1/convai/knowledge-base/url",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "xi-api-key",
              "value": "sk_cf2f6abdf8d17c22e76236f81c5c1466ffb50831ea37eae4"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "=\n{\n    \"url\": \"{{ $json.url }}\"\n\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2000,
        -400
      ],
      "id": "249be9d8-c5e9-4fea-9611-6f57b0a86202",
      "name": "Create KB"
    },
    {
      "parameters": {
        "pageId": {
          "__rl": true,
          "value": "https://www.notion.so/AI-Knowledge-Base-1ea69e60083780f0a935cff8ac44c8a1",
          "mode": "url"
        },
        "title": "={{ $('Code').item.json.fullName }}",
        "blockUi": {
          "blockValues": [
            {
              "textContent": "={{ $json.chunk }}"
            },
            {
              "textContent": "={{ $('Company Info 2000char').item.json.chunk }}"
            },
            {}
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        1800,
        -400
      ],
      "id": "fd42baa4-35ea-4726-b96b-9a970da1d32e",
      "name": "Notion Upload Page",
      "credentials": {
        "notionApi": {
          "id": "F6UQEs6NhRbwsx9v",
          "name": "Notion account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const input = $input.first().json.output; // Or use the correct field name\nconst maxLength = 2000;\n\nlet chunks = [];\nfor (let i = 0; i < input.length; i += maxLength) {\n  chunks.push({\n    chunk: input.substring(i, i + maxLength)\n  });\n}\n\nreturn chunks.map(c => ({ json: c }));\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1460,
        -400
      ],
      "id": "f18b427c-9ea2-4585-ac01-d73e0fc598ab",
      "name": "Company Info 2000char"
    },
    {
      "parameters": {
        "jsCode": "const input = $('Individual Info').first().json.output; // Or use the correct field name\nconst maxLength = 2000;\n\nlet chunks = [];\nfor (let i = 0; i < input.length; i += maxLength) {\n  chunks.push({\n    chunk: input.substring(i, i + maxLength)\n  });\n}\n\nreturn chunks.map(c => ({ json: c }));\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1640,
        -400
      ],
      "id": "63572b3a-b87e-4adf-b924-0b4655e502d8",
      "name": "Indiv Info 2000char"
    },
    {
      "parameters": {
        "method": "DELETE",
        "url": "=https://api.elevenlabs.io/v1/convai/agents/{{ $('Create Agent').item.json.agent_id }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "xi-api-key",
              "value": "sk_cf2f6abdf8d17c22e76236f81c5c1466ffb50831ea37eae4"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2700,
        -400
      ],
      "id": "40b14f4a-ee3b-4462-a8d4-e5e2d17cf8f8",
      "name": "Delete Agent"
    },
    {
      "parameters": {
        "method": "DELETE",
        "url": "=https://api.elevenlabs.io/v1/convai/knowledge-base/{{ $('Create KB').item.json.id }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "xi-api-key",
              "value": "sk_cf2f6abdf8d17c22e76236f81c5c1466ffb50831ea37eae4"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        3020,
        -400
      ],
      "id": "ec15fc8a-27b2-4d09-bc77-2a71ea8e1738",
      "name": "Delete KB"
    },
    {
      "parameters": {
        "amount": 2
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        2180,
        -400
      ],
      "id": "f89c99e4-0985-4760-9344-9792ac0e486f",
      "name": "Wait 2s",
      "webhookId": "33e28749-e0e0-42a1-9bca-3e4aa8c78828"
    },
    {
      "parameters": {
        "amount": 2
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        2860,
        -400
      ],
      "id": "6d079c30-0d2d-42a0-9fec-43f817f12d1a",
      "name": "Wait 2s1",
      "webhookId": "33e28749-e0e0-42a1-9bca-3e4aa8c78828"
    },
    {
      "parameters": {
        "unit": "minutes"
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        2540,
        -400
      ],
      "id": "4f423141-4702-4f7a-9102-fa86c4c3863b",
      "name": "Wait 2m",
      "webhookId": "5f1819d9-2a65-4463-9711-3d75a77688f2"
    },
    {
      "parameters": {
        "formTitle": "User Details",
        "formFields": {
          "values": [
            {
              "fieldLabel": "First Name",
              "placeholder": "Leonard ",
              "requiredField": true
            },
            {
              "fieldLabel": "Company Email ",
              "fieldType": "email",
              "placeholder": "leonard@legalengine.co.uk",
              "requiredField": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.2,
      "position": [
        -180,
        -400
      ],
      "id": "80886848-352f-43bf-ab4f-c8ad9c6df87f",
      "name": "On form submission",
      "webhookId": "9f1bfef6-b1fe-44dc-a593-f588fdbb179f"
    }
  ],
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "Date & Time",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Date & Time": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Individual Info",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Perplexity Firm Research": {
      "main": [
        [
          {
            "node": "Individual Info",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "Perplexity Firm Research",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Model": {
      "ai_languageModel": [
        [
          {
            "node": "Company info",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Individual Info": {
      "main": [
        [
          {
            "node": "Company info",
            "type": "main",
            "index": 0
          },
          {
            "node": "Code2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Company info": {
      "main": [
        [
          {
            "node": "Notion",
            "type": "main",
            "index": 0
          },
          {
            "node": "Code1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Company Info 2000char",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Notion": {
      "main": [
        [
          {
            "node": "Notion1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Notion1": {
      "main": [
        [
          {
            "node": "Notion2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Notion2": {
      "main": [
        [
          {
            "node": "Create Agent1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Agent1": {
      "main": [
        []
      ]
    },
    "Create KB": {
      "main": [
        [
          {
            "node": "Wait 2s",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Notion Upload Page": {
      "main": [
        [
          {
            "node": "Create KB",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Company Info 2000char": {
      "main": [
        [
          {
            "node": "Indiv Info 2000char",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Indiv Info 2000char": {
      "main": [
        [
          {
            "node": "Notion Upload Page",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Agent": {
      "main": [
        [
          {
            "node": "Wait 2m",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Delete Agent": {
      "main": [
        [
          {
            "node": "Wait 2s1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait 2s": {
      "main": [
        [
          {
            "node": "Create Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait 2s1": {
      "main": [
        [
          {
            "node": "Delete KB",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait 2m": {
      "main": [
        [
          {
            "node": "Delete Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "pinData": {
    "Webhook": [
      {
        "json": {
          "headers": {
            "host": "leonard-dev.app.n8n.cloud",
            "user-agent": "Python/3.12 aiohttp/3.11.16",
            "content-length": "7462",
            "accept": "*/*",
            "accept-encoding": "gzip, br",
            "cdn-loop": "cloudflare; loops=1; subreqs=1",
            "cf-connecting-ip": "34.67.146.145",
            "cf-ew-via": "15",
            "cf-ipcountry": "US",
            "cf-ray": "9315393647a6d646-CDG",
            "cf-worker": "n8n.cloud",
            "content-type": "application/json",
            "x-forwarded-for": "34.67.146.145, 172.71.130.233",
            "x-forwarded-host": "leonard-dev.app.n8n.cloud",
            "x-forwarded-port": "443",
            "x-forwarded-proto": "https",
            "x-forwarded-server": "traefik-prod-users-gwc-52-6c4f4684d5-xjzqs",
            "x-is-trusted": "yes",
            "x-real-ip": "34.67.146.145"
          },
          "params": {},
          "query": {},
          "body": {
            "user_email": "andy.batty@deliveroo.co.uk",
            "summary": "The matter was between Sheffield Wednesday and Nottingham Forest, dating back to a seven-one game in the early nineties. The main challenge was addressing mental scarring from childhood bullying due to supporting Sheffield Wednesday. The client sought recompense for this bullying and came to you because of your connection to both parties, leading to a fantastic outcome for the litigator. The advice cost five pounds fifty, with an estimated saving of twenty-five pounds in heartache. Simon Martin, a childhood friend and fellow victim, was a key team member. The case was based in the UK, with social considerations highlighting Nottingham High School as a difficult place for Sheffield Wednesday fans, and the novelty involved using childhood friendship for torturing other pupils. The matter is ongoing, with the client still facing ridicule for their team allegiance. There was local coverage in the Nottingham Evening Post at the time.",
            "user_name": "Leonard",
            "transcript": "Hi there Leonard, it's great to meet you, I'm Leonard, here to show you how I can make your Directories submission seamless and easy using the power of voice and AI. Once we've completed our conversation I'll send you a summary to leonard@legalengine.co.uk. Tell me about a matter you worked on to get a sense for what I'm capable of?||Yeah, so a matter between Shepard Winslow and Nottingham Forest.||Okay, I understand. To get started, could you tell me what the matter involved, including the main challenge or objective?||Yes, it was going back to the early 90s when Nottingham Forest beat Sheffield Wednesday 7-1 and I was starting to have mental scarring as a result.||Thank you for sharing that. Why did the client come to you for this matter, and what specific problem were they trying to solve?||They were trying to solve for mental torture and scarring as a result of childhood bullying for supporting a rubbish team.||I see. What was the outcome for the client, and what specific positive impact did your team provide to the client to achieve this outcome? Please also mention how this matter aligned with the client's strategic objectives.||Yes, so the client's strategic objectives were to seek recompense for childhood bullying. They came to me because I'm known to both parties and produced a fantastic outcome for the litigator.||And what was the deal size or transaction value for this matter? Were there any notable cost savings or revenue implications for the client?||It was $5,050 for the advice and I think I saved £25 in heartache.||Okay, thank you. And who were the key team members who worked with you on this matter, and what were their roles?||The main one was Simon Martin and he was there as a childhood friend and fellow victim of said bullying.||Understood. How many jurisdictions were involved in this matter, and which were the primary ones?||This was just the UK case.||Were there any innovative legal approaches or novel issues you addressed in this matter, including any precedent-setting aspects? Are there any regulatory impact or sustainability or social considerations worth highlighting?||Yeah, just social considerations were Nottingham High School was a horrible place to attend as a Sheffield Wednesday fan. And so, you know, the novelty was really around using childhood friendship as a way of torturing other pupils.||And what is the current status of this matter? If completed, when did it finish?||No, it's still open. I still get regularly shown up for my allegiance to the Owls.||Understood. Was there any press coverage or awards related to this matter that we should mention?||Not really. The Nottingham Evening Post covered it at the time, based on their own gleefulness at the victory.||Thank you for sharing those details. Let me summarise my understanding of this matter to ensure I've captured everything correctly:\n\nThe matter involves Shepard Winslow and Nottingham Forest, dating back to a seven-one game in the early nineties. The main challenge was addressing mental scarring from childhood bullying due to supporting Sheffield Wednesday. The client sought recompense for this bullying and came to you because of your connection to both parties, leading to a fantastic outcome for the litigator. The advice cost five thousand and fifty dollars, with an estimated saving of twenty-five pounds in heartache. Simon Martin, a childhood friend and fellow victim, was a key team member. The case was based in the UK, with social considerations highlighting Nottingham High School as a difficult place for Sheffield Wednesday fans, and the novelty involved using childhood friendship for torturing other pupils. The matter is ongoing, with the client still facing ridicule for their team allegiance. There was local coverage in the Nottingham Evening Post at the time.\n\nIs this summary accurate, or would you like to make any corrections before we move on?||Two corrections, so right at the start you got it wrong, it should be Sheffield Wednesday right at the start of the summary and the matter value was £5.50.||Thank you for the corrections. Let me update the summary:\n\nThe matter involves Shepard Winslow and Nottingham Forest, dating back to a seven-one game in the early nineties. The main challenge was addressing mental scarring from childhood bullying due to supporting Sheffield Wednesday. The client sought recompense for this bullying and came to you because of your connection to both parties, leading to a fantastic outcome for the litigator. The advice cost five pounds fifty, with an estimated saving of twenty-five pounds in heartache. Simon Martin, a childhood friend and fellow victim, was a key team member. The case was based in the UK, with social considerations highlighting Nottingham High School as a difficult place for Sheffield Wednesday fans, and the novelty involved using childhood friendship for torturing other pupils. The matter is ongoing, with the client still facing ridicule for their team allegiance. There was local coverage in the Nottingham Evening Post at the time.\n\nIs this summary accurate now?||No, so right at the start Leonard it should read the matter was between or related to Sheffield Wednesday and Nottingham Forest.||Okay, I understand. Let me revise the summary once more:\n\nThe matter was between Sheffield Wednesday and Nottingham Forest, dating back to a seven-one game in the early nineties. The main challenge was addressing mental scarring from childhood bullying due to supporting Sheffield Wednesday. The client sought recompense for this bullying and came to you because of your connection to both parties, leading to a fantastic outcome for the litigator. The advice cost five pounds fifty, with an estimated saving of twenty-five pounds in heartache. Simon Martin, a childhood friend and fellow victim, was a key team member. The case was based in the UK, with social considerations highlighting Nottingham High School as a difficult place for Sheffield Wednesday fans, and the novelty involved using childhood friendship for torturing other pupils. The matter is ongoing, with the client still facing ridicule for their team allegiance. There was local coverage in the Nottingham Evening Post at the time.\n\nIs this summary accurate now, or are there any further corrections?||No, all accurate thank you Leonard.All accurate now, Leonard. That's great.You still there, Leonard?"
          },
          "webhookUrl": "https://leonard-dev.app.n8n.cloud/webhook/649c7e8a-fa63-4d63-8b2b-e3bee21e3c02",
          "executionMode": "production"
        }
      }
    ]
  },
  "triggerCount": 0,
  "meta": {
    "templateCredsSetupCompleted": true
  }
}